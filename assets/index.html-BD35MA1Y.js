import{a as r,c as d,b as l,f as e,d as s,w as n,e as i,r as t,o as c}from"./app-Ce_g87Pw.js";const g={};function y(o,a){const h=t("VPCollapseItem"),k=t("VPCollapse"),p=t("VPLink");return c(),d("div",null,[a[7]||(a[7]=l(`<div class="hint-container note"><p class="hint-container-title">注</p><p>本文记录我初次接触 CTF 的经历，并顺带完成部分题的 writeups</p><p>文章内的用于下载文件的超链接未进行二次重传（懒），外网无法访问</p></div><h2 id="题目-需要-writeups" tabindex="-1"><a class="header-anchor" href="#题目-需要-writeups"><span>题目（需要 writeups）</span></a></h2><h3 id="a-copy-that" tabindex="-1"><a class="header-anchor" href="#a-copy-that"><span>A Copy That!</span></a></h3><p><strong>COPY!</strong></p><p><strong>THAT!</strong></p><p><strong>CAPCHA!</strong></p><p><strong>IN!</strong></p><p><strong>60s!!!</strong></p><p>页面中将显示一个验证码，由 7 行 的诸多 <code>IJl|1O0()i!</code> 字符构成。 请在 60 秒之内将验证码复制下来，用你喜欢的语言输出，然后提交。</p><p>Go To: https://c0p1ed.geekpie.tech/page1</p><h4 id="题解" tabindex="-1"><a class="header-anchor" href="#题解"><span>题解</span></a></h4><p>本题为签到题，比较简单</p><p>页面禁用了快捷键，但仍可 右上角三个点 -&gt; 更多工具 -&gt; 开发者工具 打开 F12</p><p>选取验证码区域，则可得到</p><figure><img src="https://image.honahec.cc/截屏2025-09-30 09.02.32.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>复制即可</p><blockquote><p>另外，使用 PHP 提交是一个很好的选择，所见即所得</p></blockquote><h3 id="d-copy-that-rev-首杀" tabindex="-1"><a class="header-anchor" href="#d-copy-that-rev-首杀"><span>D Copy That Rev! （首杀）</span></a></h3><p>“小 D，怎么回事，你的验证码弱爆了！”</p><p>“什么？怎么可能！！”</p><p>“我搜集了一下他们的手段，我猜他们大概是这样……，所以我看我们只能使用 I 公司最新研制的……”</p><p>你不屑的哼了一声，放下了监听耳机。</p><blockquote><p>由 7 行的诸多 IJl|1O0()i! 字符构成，但是只有一行</p><p>Go To: https://c0p1ed.geekpie.tech/page2</p></blockquote><h4 id="题解-1" tabindex="-1"><a class="header-anchor" href="#题解-1"><span>题解</span></a></h4><p>本题为 A 题加强版</p><p>首先把玩一下网站，发现网站禁用了快捷键，并存在某些监听事件禁止打开 F12（打开就强制跳转）</p><p>事实上，由于学艺不精，我最终并没有完全弄明白其原理，但结合 LLM 给出信息，大致总结及实操如下</p><p>LLM 告知，网站可通过以下手段检测 F12：</p><ol><li><strong>Worker 反调试检测</strong>：许多网站不在主线程检测，而是</li></ol><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">new</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> Worker</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">anti_debug.js</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">//anti_debug.js</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">setInterval</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">isDevToolsOpen</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">())</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    location</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">href</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/hacker.html</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 500</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>利用窗口大小差异</strong>：Chrome 打开 DevTools 时，浏览器窗口会被挤小</li></ol><p><strong>对于 1</strong> ，LLM 给出有效的油猴脚本：</p>`,32)),e(k,null,{default:n(()=>[e(h,{index:0},{title:n(()=>[...a[0]||(a[0]=[i("代码",-1)])]),default:n(()=>[a[1]||(a[1]=s("div",{class:"language-js line-numbers-mode","data-highlighter":"shiki","data-ext":"js",style:{"--shiki-light":"#393a34","--shiki-dark":"#dbd7caee","--shiki-light-bg":"#ffffff","--shiki-dark-bg":"#121212"}},[s("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// ==UserScript==")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// @name         Worker Debugger Neutralizer (inject)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// @namespace    http://tampermonkey.net/")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// @version      1.6")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// @description  拦截并净化创建的 WebWorker，移除 debugger 死循环 & 注入 importScripts wrapper（注入到页面上下文）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// @match        *://*/*")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// @run-at       document-start")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// @grant        none")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// ==/UserScript==")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"function"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ()"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'  "'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"use strict"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"  // 将要注入到页面上下文的代码（字符串形式）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"  const"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," INJECT_CODE"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}}," `")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"(function(){")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  // 防重复注入")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  if (window.__worker_debugger_neutralizer_installed) return;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  window.__worker_debugger_neutralizer_installed = true;")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  // 简单的代码净化函数：移除 debugger; 和常见关键字（可按需扩展）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  function sanitizeCode(src) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      // 先把单行/多行注释中的 debugger 保留（不重要），真正移除语句")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      src = src.replace(/"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"bdebugger"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"s*;?/g, '// removed debugger;');")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      // 移除明显的无限断点循环形式（举例）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      src = src.replace(/for"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"s*"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"("),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"s*let"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"s+[^;]+;"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"s*[^;]+;"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"s*[^"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},")]+"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},")"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"s*{"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"s*debugger"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"s*;?"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"s*}/g, '// removed loop-debugger');")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      // 标记/替换 devtools 单词避免检测 toString 等")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      src = src.replace(/"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"bdevtools"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"b/gi, 'dev_tools');")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      return src;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    } catch (e) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      return src;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  }")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  // 在 Worker 源码前注入 wrapper，重写 importScripts、console、setTimeout 等，尽可能先行保护")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  function makeWrapperPrefix() {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    return '"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '(function(){"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '  try{"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '    const _importScripts = self.importScripts;"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '    self.importScripts = function(){"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '      try{"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '        const sanitizedArgs = Array.prototype.slice.call(arguments).map(function(u){"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '          // 如果是相对/绝对 URL，尝试 fetch 替换里面的 debugger（若失败回退原 URL）"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '          return u;"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '        });"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '        return _importScripts.apply(self, sanitizedArgs);"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '      }catch(e){"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '        try{ return _importScripts.apply(self, arguments); }catch(e){}"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '      }"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '    };"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '  }catch(e){}"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '  // 防止 worker 内再触发 debugger 造成卡死"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '  try{"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '    Object.defineProperty(self, "),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},'\\"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"debugger"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},'\\"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},", { get: function(){ return undefined; }, configurable: true });"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '  }catch(e){}"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '  // 覆盖 setInterval/setTimeout 以防止外部注入死循环检测"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '  try{"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '    const _si = self.setInterval; const _st = self.setTimeout;"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '    self.setInterval = function(fn, t){ if(typeof fn === "),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},'\\"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"function"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},'\\"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},") { return _si(function(){ try{ return fn.apply(this,arguments); }catch(e){} }, t); } return _si(fn,t); };"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '    self.setTimeout = function(fn, t){ if(typeof fn === "),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},'\\"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"function"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},'\\"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},") { return _st(function(){ try{ return fn.apply(this,arguments); }catch(e){} }, t); } return _st(fn,t); };"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '  }catch(e){}"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' +")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      '})();"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n';")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  }")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  const wrapperPrefix = makeWrapperPrefix();")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  // 保存原始 Worker 构造")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  const RealWorker = window.Worker;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  const realCreateObjectURL = URL.createObjectURL.bind(URL);")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  // 用于生成真实 Worker 的辅助（异步）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  async function createSanitizedWorkerFromSourceText(src, options) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      const sanitized = sanitizeCode(src);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      const finalSrc = wrapperPrefix + '"),s("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\\\"),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"n' + sanitized;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      const blob = new Blob([finalSrc], { type: 'application/javascript' });")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      const blobUrl = realCreateObjectURL(blob);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      return new RealWorker(blobUrl, options);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    } catch (e) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      // 失败回退：直接尝试用原始脚本（可能包含 debugger）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        const blob = new Blob([src], { type: 'application/javascript' });")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        const blobUrl = realCreateObjectURL(blob);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        return new RealWorker(blobUrl, options);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      } catch (ee) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        throw ee;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  }")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  // 返回一个“伪 Worker”并异步创建真实 Worker，完成后转发")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  function makeProxyWorker() {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    let _listeners = {};")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    let _onmessage = null;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    let _real = null;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    let _pendingMsgs = [];")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    let _terminated = false;")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    const proxy = {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      // 标准 API：postMessage")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      postMessage: function(msg, transfer) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        if (_terminated) return;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        if (_real) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          try { _real.postMessage(msg, transfer); } catch(e) {}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        } else {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          _pendingMsgs.push({msg, transfer});")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      },")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      addEventListener: function(type, cb) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        _listeners[type] = _listeners[type] || new Set();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        _listeners[type].add(cb);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      },")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      removeEventListener: function(type, cb) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        if (_listeners[type]) _listeners[type].delete(cb);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      },")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      terminate: function() {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        _terminated = true;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        try { if (_real) _real.terminate(); }catch(e){}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        _real = null;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        _listeners = {};")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        _pendingMsgs = [];")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      },")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      // onmessage 属性")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      set onmessage(fn) { _onmessage = fn; },")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      get onmessage() { return _onmessage; },")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      // 内部：把真实 worker 绑定到代理并转发事件")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      _bindReal: function(realWorker) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        if (_terminated) { try{ realWorker.terminate(); }catch(e){}; return; }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        _real = realWorker;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        // 转发 pending messages")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        for (const p of _pendingMsgs) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          try { _real.postMessage(p.msg, p.transfer); } catch(e) {}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        _pendingMsgs = [];")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        // 绑定事件转发")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        _real.onmessage = function(ev) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          // 先触发 onmessage 回调")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          try { if (typeof _onmessage === 'function') _onmessage.call(proxy, ev); } catch(e){}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          // 再触发 addEventListener 注册的回调")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            const s = _listeners['message'];")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            if (s) for (const cb of s) { try{ cb.call(proxy, ev); }catch(e){} }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          } catch(e){}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        };")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        // 支持 messageerror")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        _real.onmessageerror = function(ev) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            const s = _listeners['messageerror'];")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            if (s) for (const cb of s) { try{ cb.call(proxy, ev); }catch(e){} }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          } catch(e){}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        };")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    };")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    return proxy;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  }")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  // 覆盖 window.Worker")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  window.Worker = function(scriptURL, options) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    // 1) 如果第二个参数 omitted，options 可能为 undefined — 直接传透")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    const proxy = makeProxyWorker();")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    // 异步处理各种 scriptURL 类型")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    (async function() {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        // helper: 获取脚本文本（若可行）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        async function fetchTextFrom(url) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            // 尝试 fetch（CORS 可能阻止）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            const r = await fetch(url, { credentials: 'same-origin' });")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            if (!r.ok) throw new Error('fetch failed:' + r.status);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            return await r.text();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          } catch (e) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            // 作为回退，试试 XMLHttpRequest 同源同步（仅对同源有效）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              const xhr = new XMLHttpRequest();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              xhr.open('GET', url, false); // 同步")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              xhr.send(null);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              if (xhr.status === 200 || (location.protocol === 'file:' && xhr.status === 0)) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"                return xhr.responseText;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            } catch (ee){}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            throw e;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        }")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        // 处理不同形式的 scriptURL")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        if (typeof scriptURL === 'string') {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          if (scriptURL.startsWith('blob:')) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            // 对 blob: URL，尝试 fetch 并读取文本")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              const txt = await (await fetch(scriptURL)).text();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              const real = await createSanitizedWorkerFromSourceText(txt, options);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              proxy._bindReal(real);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              return;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            } catch (e) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              // 回退：直接创建原始 Worker")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              try { const real = new RealWorker(scriptURL, options); proxy._bindReal(real); return; } catch(e){}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          } else if (scriptURL.startsWith('data:')) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            // data URL：解码出内容")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              const comma = scriptURL.indexOf(',');")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              const meta = scriptURL.substring(5, comma);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              const data = scriptURL.substring(comma + 1);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              const isBase64 = /base64/i.test(meta);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              const txt = isBase64 ? atob(data) : decodeURIComponent(data);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              const real = await createSanitizedWorkerFromSourceText(txt, options);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              proxy._bindReal(real);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              return;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            } catch (e) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              try { const real = new RealWorker(scriptURL, options); proxy._bindReal(real); return; } catch(e){}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          } else {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            // 普通 URL（可能跨域）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              const txt = await fetchTextFrom(scriptURL);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              const real = await createSanitizedWorkerFromSourceText(txt, options);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              proxy._bindReal(real);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              return;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            } catch (e) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              // 失败（CORS 等），回退到直接用原始 URL")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"              try { const real = new RealWorker(scriptURL, options); proxy._bindReal(real); return; } catch(e){}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        } else if (scriptURL instanceof Blob) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            const txt = await (new Response(scriptURL)).text();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            const real = await createSanitizedWorkerFromSourceText(txt, options);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            proxy._bindReal(real);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            return;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          } catch (e) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"            try { const url = realCreateObjectURL(scriptURL); const real = new RealWorker(url, options); proxy._bindReal(real); return; } catch(e){}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"          }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        }")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        // 最后回退：直接尝试构造（如果上面都没成功）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        try { const real = new RealWorker(scriptURL, options); proxy._bindReal(real); return; } catch(e){ console.error('Worker creation fallback failed', e); }")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      } catch (err) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        // 万一整个流程失败，尝试直接使用原始 Worker")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        try { const real = new RealWorker(scriptURL, options); proxy._bindReal(real); } catch(e) { console.error('create worker failed', e); }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    })();")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    return proxy;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  };")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  // 保证 new Worker.prototype instanceof Worker 的行为兼容（尽力）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    window.Worker.prototype = RealWorker.prototype;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  } catch(e){}")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  // 覆盖 URL.createObjectURL：让 Blob->objectURL 的情况也被捕获（可选）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  (function(){")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    const orig = URL.createObjectURL.bind(URL);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    URL.createObjectURL = function(obj) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      try {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        // 直接返回原始行为（我们主要在 Worker ctor 里处理 Blob 内容）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        return orig(obj);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      } catch(e) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"        return orig(obj);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"      }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"    };")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"  })();")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"})();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"`"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";"),s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}}," // end INJECT_CODE")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"  // 把脚本注入到页面上下文：在 documentElement 前插入一个 <script>")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"  function"),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," inject"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"code"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"    try"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"      const"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," el"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," document"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"createElement"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"script"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      el"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"textContent"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," code"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"      // 标记并立即插入，尽量在页面脚本之前运行")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"      const"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," ref"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," document"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"documentElement"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," ||"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," document"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"head"),s("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," ||"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," document"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"body"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"      if"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ("),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"ref"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," ref"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"prepend"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"el"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"      else"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," document"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"documentElement"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"appendChild"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"el"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"      // 可选：移除脚本标签以免泄露")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"      setTimeout"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"(()"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," =>"),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," el"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"remove"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"(),"),s("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1000"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"    }"),s("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}}," catch"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ("),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"e"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      console"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"error"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"inject failed"),s("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},'"'),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," e"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"    }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"  }")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"  inject"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),s("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"INJECT_CODE"),s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"})();")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1))]),_:1})]),_:1}),a[8]||(a[8]=l('<br> 这个脚本干了以下几件事： <ul><li>所有 <code>debugger</code> 都被正则替换掉</li><li><code>devtools</code> 关键字被改写</li><li><code>importScripts()</code> 里的反调试加载被中和</li></ul><p>Worker 层检测没机会触发跳转</p><p>而<strong>对于 2</strong> ，我本想让 LLM 也给出一个脚本，但失败了，于是灵机一动打开了 Devtools 的移动设备模式（跳转 hacker 页面后可打开 F12，打开后返回）</p><ul><li>开启移动模式时，Chrome 会把页面渲染在一个“模拟设备视口”中</li><li>这时 <code>innerWidth</code> / <code>outerWidth</code> 的差值几乎恒定，<strong>不会反映 DevTools 是否打开</strong></li></ul><p>因此这类检测逻辑失效</p><p>至此，可顺利打开 F12，完成了本题的 <strong>第一部分</strong></p><p>事情并没有那么简单</p><figure><img src="https://image.honahec.cc/20251001154523039.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>完整字符被分割到四个 chunk 中，每个 chunk 中又对字符进行了分割为数个 data 并赋予 id，我本以为只需手速够快，在 60s 内复制全部字符并提交即可，失败两次后冷静下来继续研究，页面展示的字符顺序与 Elements 中顺序并不一致：（可自行核对，上下图片为同一次请求）</p><figure><img src="https://image.honahec.cc/20251001154501771.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>简单观察我们可以轻松得到第一个结论：<strong>四个 chunk 是按照顺序出现的</strong></p><p>难点在于，chunk 内部字符如何排序？</p><p>对此 div 的 sytle 进行简单探索，找到如下代码：</p><figure><img src="https://image.honahec.cc/Snipaste_2025-10-01_15-51-49.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>此处给出了 chunk 内元素的排序规则：<strong>先 before 再 after，内部按先后排序</strong></p><p>到此，最快的方法就是使用合适的 prompt，给 LLM style 和四个 chunk 让它 <strong>不要废话</strong> 给出最终的完整字符</p><h3 id="g-git" tabindex="-1"><a class="header-anchor" href="#g-git"><span>G Git</span></a></h3><p>Flag was hidden in Git repositories. Find them.</p><p><a href="https://acm.shanghaitech.edu.cn/d/G3eKP1E_2025/p/10/file/Git.zip?type=additional_file" target="_blank" rel="noopener noreferrer">Download repos</a></p><h4 id="题解-2" tabindex="-1"><a class="header-anchor" href="#题解-2"><span>题解</span></a></h4>',22)),s("p",null,[a[3]||(a[3]=i("本题给出了四个 Git 仓库，并考察 Git 对象 知识，可查看我博客上的相关内容：",-1)),e(p,{href:"./GitObject.md"},{default:n(()=>[...a[2]||(a[2]=[i("Git 对象",-1)])]),_:1}),a[4]||(a[4]=i("（外部跳转请访问 ",-1)),a[5]||(a[5]=s("a",{href:"https://blog.honahec.cc/blog/iftjzdbk/",target:"_blank",rel:"noopener noreferrer"},"Git 对象",-1)),a[6]||(a[6]=i("）",-1))]),a[9]||(a[9]=l(`<p>涵盖了本题考察内容</p><h3 id="h-不知名观光地" tabindex="-1"><a class="header-anchor" href="#h-不知名观光地"><span>H 不知名观光地</span></a></h3><p>你从 ??? 那里获得了一份 <a href="https://acm.shanghaitech.edu.cn/d/G3eKP1E_2025/p/10/file/12345678?type=additional_file" target="_blank" rel="noopener noreferrer">神秘文件 (?)</a></p><p>如果是你的话，一定能追逐到属于自己的 ■■■■ 吧</p><h4 id="题解-3" tabindex="-1"><a class="header-anchor" href="#题解-3"><span>题解</span></a></h4><p><s>也许本题才是签到题（？</s></p><p>本题给出了一张图片和一个 readme.txt</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>//readme.txt</span></span>
<span class="line"><span>VkdobElHNWxZWEpsYzNRZ2RISmhhVzRnYzNSaGRHbHZiam9nWDE5ZlgxOGdVM1JoZEdsdmJpQW9SVzVuYkdsemFDQnZibXg1SVNrPQ==</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>最后具有两个等号（base64 补位字符），简单判断这是 base64 编码内容</p><p>解码一次后</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>//From base64 1</span></span>
<span class="line"><span>VGhlIG5lYXJlc3QgdHJhaW4gc3RhdGlvbjogX19fX18gU3RhdGlvbiAoRW5nbGlzaCBvbmx5ISk=</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>最后还有一个等号，应该还可以继续解码</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>//From base64 2</span></span>
<span class="line"><span>The nearest train station: _____ Station (English only!)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>那本题很明了了，判断图片位置并找出最近车站</p><img src="https://image.honahec.cc/congratulations.png" style="zoom:20%;"><p>出题人十分友好，图片可直接扔 Google 搜索到，加上内置的 Gemeni 就秒掉了</p><figure><img src="https://image.honahec.cc/20251001162009352.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="i-❖-kaleid×scope-❖" tabindex="-1"><a class="header-anchor" href="#i-❖-kaleid×scope-❖"><span>I ❖ 𝐊𝐀𝐋𝐄𝐈𝐃×𝐒𝐂𝐎𝐏𝐄 ❖</span></a></h3><blockquote><p>「六面海报，六道回声。 当光被切分成碎片，世界会在碎缝里低语——听见它的人，会把碎片拼回。」</p></blockquote><p>你被昏暗中召唤。 在废弃剧院的后台，在舞台掩映处， 六张海报被撕裂，散落在墙壁、舞台侧翼、道具箱底。 每一张都像是一个节拍、一次回声、一段折光——它们彼此独立，却又被同一条隐秘的线牵连。</p><p>当你按顺序拾起六个 key， 光谱将重组，旗帜将升起。</p><figure><img src="https://image.honahec.cc/20251001162242780.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="题解-4" tabindex="-1"><a class="header-anchor" href="#题解-4"><span>题解</span></a></h4><p>本题为此次比赛唯二的线下题之一，首先需要在学校各处找海报（6 张有二维码的）</p><blockquote><p>海报不在此处贴出了</p></blockquote><p>这六个二维码分别给出了以下链接</p><p>https://2025.geekpie.club/Arch</p><p>https://2025.geekpie.club/Web</p><p>https://2025.geekpie.club/CTF</p><p>https://2025.geekpie.club/HardCore</p><p>https://2025.geekpie.club/HPC</p><p>https://2025.geekpie.club/DevOps</p><p>相较于 https://2025.geekpie.club，简单观察网站后不难发现，这些网站下方的Terminal中多出了两段（Arch为一段，无next_hash）内容：（以 /Web 为例）</p><figure><img src="https://image.honahec.cc/20251001163840474.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>整理可得：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>/Arch</span></span>
<span class="line"><span>fragment = &quot;_-_-__-_&quot;)}&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/Web</span></span>
<span class="line"><span>fragment = &quot;if(scan==6)_&quot;</span></span>
<span class="line"><span>next_hash: ac0f686269601e20f9e587992e2b4fb0e50ccae8647eed01694d23c78815e731</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/CTF</span></span>
<span class="line"><span>fragment: &quot;GEEK&quot;</span></span>
<span class="line"><span>next_hash: 37dd2c2e535a3c39b1a73cd610bb9c523614350aadceafd6571c23b6f1218b95</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/HardCore</span></span>
<span class="line"><span>fragment: &quot;PIE{&quot;</span></span>
<span class="line"><span>next_hash: 75dd84ad438833f05c559d7d7aed325d2ad5d19f77ef257561ddeb74bae9f156</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/HPC</span></span>
<span class="line"><span>fragment: &quot;--_------&quot;</span></span>
<span class="line"><span>next_hash: debd8c9a239afcab371dda416f4521b66979ae356894cc67ca320d7a74a5b6be</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/DevOps</span></span>
<span class="line"><span>fragment: &quot;print(&quot;GeekPie&quot;</span></span>
<span class="line"><span>next_hash: 1f649cdf7e7c8558c988059adcf546a9b6f902c4543c28092dc598511bd6a41d</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>思路一目了然</p><table><thead><tr><th>模块名</th><th>fragment</th><th>SHA256(fragment)</th><th>next_hash 指向</th></tr></thead><tbody><tr><td>CTF</td><td>GEEK</td><td>b90172fa...</td><td>HardCore</td></tr><tr><td>HardCore</td><td>PIE{</td><td>37dd2c2e...b95</td><td>Web</td></tr><tr><td>Web</td><td>if(scan==6)_</td><td>75dd84ad...156</td><td>DevOps</td></tr><tr><td>DevOps</td><td>print(&quot;GeekPi\`</td><td>ac0f6862...e731</td><td>HPC</td></tr><tr><td>HPC</td><td>--_-----</td><td>1f649cdf...a41d</td><td>Arch</td></tr><tr><td>Arch</td><td><em>-</em>-_<em>-</em>&quot;)}</td><td>debd8c9a...b6be</td><td></td></tr></tbody></table><p>则 flag 为 <code>GEEKPIE{if(scan==6)_print(&quot;GeekPie--_------_-_-__-_&quot;)}</code></p><h3 id="l-can-u-tell-me-how-much-the-shirt-is" tabindex="-1"><a class="header-anchor" href="#l-can-u-tell-me-how-much-the-shirt-is"><span>L Can u tell me how much the shirt is?</span></a></h3><blockquote><p>怎么 CTF 还有听力题 😭👊</p></blockquote><p><strong>小故事</strong></p><p>出题人小时候英语听力没认真做被扣分了</p><p><strong>描述</strong></p><p>这是一个基于 Unity 的听力播放软件。</p><p>你需要先根据自己的平台下载附件，提供 <a href="https://acm.shanghaitech.edu.cn/d/G3eKP1E_2025/p/10/file/Windows.zip?type=additional_file" target="_blank" rel="noopener noreferrer">Windows</a> 和 <a href="https://acm.shanghaitech.edu.cn/d/G3eKP1E_2025/p/10/file/MacOS.zip?type=additional_file" target="_blank" rel="noopener noreferrer">MacOS</a> 版本。</p><blockquote><p>Note: 不保证在所有系统版本下都能运行。如果你没有兼容的系统，可以尝试运行虚拟机或云电脑。但如果你使用 Windows 或 MacOS 却不能直接运行，请及时反馈喵！</p></blockquote><p><strong>注意</strong></p><ol><li>你应该<strong>仅</strong>提交形如 GEEKPIE{...} 的 flag，{...} 内没有多余的括号，<strong>不需要使用代码输出</strong></li><li>鉴于本题 flag 形式的特殊性，接受忽略大小写的内容</li><li>提交中不应包含任何空白字符，比如 <code>ㅤ</code> 或 tab、换行符</li></ol><h4 id="题解-5" tabindex="-1"><a class="header-anchor" href="#题解-5"><span>题解</span></a></h4><p>人脉题，无需多言，一看到音频我没有任何犹豫扔给了我的好哥们 <a href="https://github.com/modenicheng" target="_blank" rel="noopener noreferrer">@Modenc</a></p><p>不负众 <s>（也许不众）</s> 望，历时两个半小时解决（（</p><img src="https://image.honahec.cc/e1dbcf0eb71f763af3d6056f8b336c97.jpg" style="zoom:50%;"><p>附他的<a href="https://modenc.top/article/noeu6vz4/" target="_blank" rel="noopener noreferrer">博客题解</a>（20251004 后链接有效）</p><h3 id="m-electronic-engineering" tabindex="-1"><a class="header-anchor" href="#m-electronic-engineering"><span>M Electronic Engineering</span></a></h3><p><strong>说明</strong></p><p>下方左数第二个<strong>TSSOP-16</strong>封装的元件为<strong>TMUX1108</strong>。请自行查询相关资料，以及实际的电路连接方式等信息，回答以下问题。</p><p>当我需要读取网络名为<strong>ADCL3</strong>的数据时，该元件除电源引脚外，哪些引脚需要被拉高/低？请填写相关引脚，并将剩下的引脚留空。请进入<a href="http://139.196.14.200:11456/" target="_blank" rel="noopener noreferrer">这个链接</a>查阅具体信息，并将输出的 flag 提交。</p><figure><img src="https://image.honahec.cc/20251001165603879.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="题解-6" tabindex="-1"><a class="header-anchor" href="#题解-6"><span>题解</span></a></h4><p>是完全盲区的方向</p><p>感觉 LLM 很难做出来这种题（主要我不知道怎么写 prompt 和解释线路如何连接的）于是先让它简要介绍一下 TMUX1108 和 这道题让我们做的事，得到了很惊喜的回复：</p><p><strong>芯片工作原理：TMUX1108 是 1-选-8 模拟多路复用器</strong></p><p>也就是说，一个公共端 D，可以通过控制信号 A2、A1、A0 选择接通到其中一个输入端 S1–S8。</p><p>它的核心控制逻辑是 <strong>3 位二进制地址</strong>：</p><blockquote><p>A2A1A0 → 选择 Sx</p></blockquote><p>而且它还有一个 <strong>EN（使能）</strong> 引脚，</p><ul><li>当 EN = 1（高电平） 时，芯片正常工作，</li><li>当 EN = 0（低电平） 时，所有通道都断开（高阻状态）。</li></ul><p><strong>地址真值表（来自 TI 官方 datasheet）</strong></p><table><thead><tr><th>A2</th><th>A1</th><th>A0</th><th>选通通道</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>S1</td></tr><tr><td>0</td><td>0</td><td>1</td><td>S2</td></tr><tr><td>0</td><td>1</td><td>0</td><td>S3</td></tr><tr><td>0</td><td>1</td><td>1</td><td>S4</td></tr><tr><td>1</td><td>0</td><td>0</td><td>S5</td></tr><tr><td>1</td><td>0</td><td>1</td><td>S6</td></tr><tr><td>1</td><td>1</td><td>0</td><td>S7</td></tr><tr><td>1</td><td>1</td><td>1</td><td>S8</td></tr></tbody></table><p><strong>转换成引脚编号（TSSOP-16 封装）</strong></p><table><thead><tr><th>引脚号</th><th>名称</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>A0</td><td>地址最低位</td></tr><tr><td>2</td><td>EN</td><td>使能，高有效</td></tr><tr><td>15</td><td>A2</td><td>地址最高位</td></tr><tr><td>16</td><td>A1</td><td>地址中间位</td></tr></tbody></table><p>也就是说，只要控制好 <strong>引脚 1、2、15、16</strong> 的电平，就能选通不同的 S 通道</p><p>这是一个非常好的消息（可枚举）</p><p>于是，我让 LLM 给出了所有可能性：</p><table><thead><tr><th>通道</th><th>A2</th><th>A1</th><th>A0</th><th>EN</th><th>对应引脚设置（1,2,15,16）</th></tr></thead><tbody><tr><td>S1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1=低，2=高，15=低，16=低</td></tr><tr><td>S2</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1=高，2=高，15=低，16=低</td></tr><tr><td>S3</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1=低，2=高，15=低，16=高</td></tr><tr><td>S4</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1=高，2=高，15=低，16=高</td></tr><tr><td>S5</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1=低，2=高，15=高，16=低</td></tr><tr><td>S6</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1=高，2=高，15=高，16=低</td></tr><tr><td>S7</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1=低，2=高，15=高，16=高</td></tr><tr><td>S8</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1=高，2=高，15=高，16=高</td></tr></tbody></table><p>枚举即可完成</p><h3 id="q-hello-shtechcraft" tabindex="-1"><a class="header-anchor" href="#q-hello-shtechcraft"><span>Q Hello SHTechCraft</span></a></h3><p><strong>题目描述</strong></p><p>这是一个 <strong>DevOps 方向的题目</strong>。 你需要参考 <a href="https://github.com/HenryZ16/shtechcraft-tutorial" target="_blank" rel="noopener noreferrer">shtechcraft-tutorial</a>，并完成以下任务。</p><hr><p><strong>任务要求</strong></p><ol><li>编写 Dockerfile</li></ol><p>你的 Dockerfile 应该能够构建出一个可直接运行的 <strong>Minecraft 原版 1.21.8 服务器</strong>。</p><p>具体要求：</p><ul><li>基础镜像：使用 hello-shtechcraft-base:v1 <ul><li>它包含一个 RCON_PASSWORD 环境变量</li></ul></li><li>配置 RCON 连接： <ul><li>RCON 密码需要从环境变量 RCON_PASSWORD 获取</li><li>评测器会通过宿主机的 30075 端口来测试 RCON</li></ul></li></ul><p>构建完成后，镜像的名称应为：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>hello-shtechcraft:v1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>运行服务器</li></ol><p>你需要提供用于 docker run 的完整参数，保证服务器正常启动。</p><p>要求：</p><ul><li>挂载题目提供的存档 world.tar.gz（需要先解压）</li><li>开放 RCON 端口</li><li>运行镜像 hello-shtechcraft:v1</li></ul><p>当服务器成功启动后，你需要运行题目提供的本地评测器进行测试。</p><hr><p><strong>评分方式</strong></p><p>本题采用 <strong>本地运行 + 动态 flag 提交</strong> 的评测方式。</p><p>你需要提交以下形式的代码：</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">print</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&lt;your flag&gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>其中 <code>&lt;your flag&gt;</code> 是本地评测器输出的结果，例如：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>flag{XXXead3f}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>本地评测器的工作流程</p><ol><li>要求输入： <ul><li>启动镜像所用的参数（不需要 -d 和 --name）</li></ul></li><li>检测内容： <ul><li>MC 版本：通过 /version 命令，验证是否运行了 1.21.8 版本</li><li>存档内容：检查某个坐标的方块，验证是否正确挂载存档目录</li></ul></li><li>验证通过后： <ul><li>评测器会要求输入 usercert</li><li>输入正确后，评测器输出 flag</li></ul></li></ol><p>只有通过全部检测后，才能获得本题分数。</p><p>该评分方式旨在模拟真实场景下，用 docker 封装的网络服务。它们首先要能保证响应用户的交互；其次还需要保证能持久化自己的数据</p><p><strong>注意</strong>，如果你在 Windows 平台进行测试，local checker 并不能自动超时退出。如果你的等待时间过长，请手动结束 local checker，并检查你配置的镜像，或输入的 docker run 参数等</p><p>（题目太长省略掉后面的）</p><h4 id="题解-7" tabindex="-1"><a class="header-anchor" href="#题解-7"><span>题解</span></a></h4><blockquote><p>环境 Windows11 + wsl2(debian)</p></blockquote><p>首先导入基础镜像</p><div class="language-powershell line-numbers-mode" data-highlighter="shiki" data-ext="powershell" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-powershell"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">docker load </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">-</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">i .\\hello</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">-</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">shtechcraft</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">-</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">base</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">-</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">v1.tar</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>新建一个文件夹放必要文件，并解压 world 到同级目录</p><ul><li>Dockerfile</li><li>start.sh</li><li>server.properties.tmpl</li><li>server-1.21.8.jar</li><li>java21.deb</li><li>world</li></ul><p><strong>配置 Dockerfile</strong></p><div class="language-dockerfile line-numbers-mode" data-highlighter="shiki" data-ext="dockerfile" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-dockerfile"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 基础镜像</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> hello-shtechcraft-base:v1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WORKDIR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> /mc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 安装 Java 21</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">COPY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> java21.deb /tmp/java21.deb</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">RUN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> apt-get update &amp;&amp; \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    dpkg -i /tmp/java21.deb || (apt-get -f install -y &amp;&amp; dpkg -i /tmp/java21.deb) &amp;&amp; \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    rm -f /tmp/java21.deb &amp;&amp; \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 放入原版 1.21.8 服务端</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">COPY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> server-1.21.8.jar /mc/server.jar</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 启动脚本 &amp; 配置模板</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">COPY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> start.sh /usr/local/bin/start.sh</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">COPY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> server.properties.tmpl /mc/server.properties.tmpl</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">RUN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> chmod +x /usr/local/bin/start.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># JVM 默认参数</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ENV</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> JVM_OPTS=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;-Xms512m -Xmx2g&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 开放端口</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">EXPOSE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> 25565 25575</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 挂载点</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">VOLUME</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;/mc/world&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;/mc/logs&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ENTRYPOINT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;/usr/local/bin/start.sh&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>配置 start.sh</strong></p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#!/usr/local/bin bash</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">set</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -euo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pipefail</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /mc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># EULA</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">eula=true</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /mc/eula.txt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 防止没有 server.properties</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> !</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> -f</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> /mc/server.properties </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">];</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> then</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  cp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /mc/server.properties.tmpl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /mc/server.properties</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 从环境变量取 RCON_PASSWORD，防止意外留 -changeme（实际没用）</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">RCON_VAL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">RCON_PASSWORD</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">:-</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">changeme</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">cat</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /mc/server.properties.new</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;&lt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">EOF</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">enable-rcon=true</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">rcon.port=25575</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">rcon.password=</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\${</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">RCON_VAL</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">level-name=world</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">motd=Hello ShTechCraft 1.21.8</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">enable-query=true</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">server-ip=</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">server-port=25565</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mv</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /mc/server.properties.new</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /mc/server.properties</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 启动原版 MC</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">exec</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> java</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> \${</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">JVM_OPTS</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">:-</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">-Xms512m -Xmx2g</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -jar</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /mc/server.jar</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nogui</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>server.properties.tmpl</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>allow-flight=false</span></span>
<span class="line"><span>difficulty=easy</span></span>
<span class="line"><span>gamemode=survival</span></span>
<span class="line"><span>pvp=true</span></span>
<span class="line"><span>max-players=20</span></span>
<span class="line"><span>view-distance=10</span></span>
<span class="line"><span>simulation-distance=10</span></span>
<span class="line"><span>online-mode=true</span></span>
<span class="line"><span>spawn-protection=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>server-port=25565</span></span>
<span class="line"><span>query.port=25565</span></span>
<span class="line"><span></span></span>
<span class="line"><span>level-name=world</span></span>
<span class="line"><span></span></span>
<span class="line"><span>enable-rcon=false</span></span>
<span class="line"><span>rcon.port=25575</span></span>
<span class="line"><span>rcon.password=</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>构建镜像</strong></p><div class="language-powershell line-numbers-mode" data-highlighter="shiki" data-ext="powershell" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-powershell"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">docker build </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">-</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">t hello</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">-</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">shtechcraft:v1 .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>随后写个 your-args.txt （懒得想名字了，就这个吧）</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>-p 30075:25575 -v /mnt/c/path/to/world:/mc/world hello-shtechcraft:v1</span></span>
<span class="line"><span>&lt;usercert&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>在 wsl2 里跑起来（其实 windows 也可以，但我 debug 的时候去 debian 里跑了）</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./local_checker</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> your-args.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>至此，得到了 flag</p><h2 id="题目-不需要-writeups" tabindex="-1"><a class="header-anchor" href="#题目-不需要-writeups"><span>题目（不需要 writeups）</span></a></h2><blockquote><p>本部分题目我未在前三完成，理论上不需要写 writeups，但我想写</p></blockquote><h3 id="n-不是网易云" tabindex="-1"><a class="header-anchor" href="#n-不是网易云"><span>N 不是网易云</span></a></h3><p><strong>背景</strong></p><p><strong>注意：本题仅供学习使用</strong></p><p>Yanami Anna 想要制作一个爬虫（？，而日常使用得最多的音乐平台无非网易云或者 QQ 音乐。毫无疑问，网易云一点加密也没有的接口（不过现在<em>部分</em>有了）被她瞬间秒掉。邪恶的眼睛盯上了 QQ 音乐，却发现了“超高难度”加密接口！</p><p>由于需求不高，你只需要考虑一种简单的情况（当然其他情况也类似），尝试调用 QQ 音乐的接口，根据专辑的 MID 获取专辑具体信息（包括专辑名称、封面图片、每首歌曲的信息等）。</p><p><strong>说明</strong></p><p>众所周知（?）<a href="https://music.qq.com/" target="_blank" rel="noopener noreferrer">QQ 音乐网页端</a> 在请求各类数据时会 POST 这样的接口：https://u6.y.qq.com/cgi-bin/musics.fcg?_=1757578164322&amp;encoding=ag-1&amp;sign=zzc1094ddshenmishuzidesignootkfvnthisisfake</p><p>而这其中 sign 是某个函数传入 payload（大概率是 JSON）后计算出的开头为 &quot;zzc&quot; 的一个字符串（注意是 zzc 而非旧版的 zzb）。你需要提取出相关代码（提示：无需破解具体算法）。</p><p><a href="https://acm.shanghaitech.edu.cn/d/G3eKP1E_2025/p/10/file/qqmusic.zip?type=additional_file" target="_blank" rel="noopener noreferrer">点击此处下载附件</a> 附件给出了模板代码，你需要完善 getSign 函数，并使用这份 Node.js 脚本获取任意你喜欢的专辑的具体信息。</p><p>可以使用下面的命令行运行代码（需要先安装 Node.js 环境）</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">node</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> qqmusic_album.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>注意</strong>：不要随意修改附件给出的模拟浏览器环境 （除非你明白为什么要这么做），否则会影响最终 sign 值。</p><h4 id="题解-8" tabindex="-1"><a class="header-anchor" href="#题解-8"><span>题解</span></a></h4><p>依旧人脉题，本题扔给了我的另一个好哥们 <a href="https://github.com/yxzlwz" target="_blank" rel="noopener noreferrer">@yxzlwz</a></p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// submit_template.js</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 模板已更新：你只需要完成这个函数即可，不需要包含模拟环境</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 你不能在这个文件中使用 require, global 等关键字</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> getSign</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">dataStr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // TODO</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>看起来就是传入一个 dataStr 返回 sign 即可</p><p>首先把玩一下 QQ 音乐的网站，全局搜索一下为 sign 赋值的地方：</p><figure><img src="https://image.honahec.cc/20251001180101332.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>随后给可疑的地方打上断点，找到 sign 的值</p><figure><img src="https://image.honahec.cc/image-20251001180304841.png" alt="image-20251001180304841" tabindex="0" loading="lazy"><figcaption>image-20251001180304841</figcaption></figure><p>很明显就是这个 P 返回了 sign，我们跳过去看看是什么牛鬼蛇神</p><figure><img src="https://image.honahec.cc/20251001180515549.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>进来之后我们可以发现这是一个 webpack 打包的格式</p><p>在这个函数里，我们找 P 是在哪里导出的</p><figure><img src="https://image.honahec.cc/image-20251001212937916.png" alt="image-20251001212937916" tabindex="0" loading="lazy"><figcaption>image-20251001212937916</figcaption></figure><p>这个 _getSecuritySign 就应该是它签名的算法</p><p>对于常规的 Webpack 我们要找到它的加载器和模块，使用加载器来调用模块</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">!</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 加载器</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">})([</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  // 模块</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">]);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在刚才那个函数的最后，我们可以发现</p><figure><img src="https://image.honahec.cc/image-20251001213509882.png" alt="image-20251001213509882" tabindex="0" loading="lazy"><figcaption>image-20251001213509882</figcaption></figure><p>这个 n 就是来调模块的，我们在这里打个断点看看</p><figure><img src="https://image.honahec.cc/image-20251001213725867.png" alt="image-20251001213725867" tabindex="0" loading="lazy"><figcaption>image-20251001213725867</figcaption></figure><p>这个 m 就是这个加载器可以调用的模块</p><p>此时我们可以使用 DevTools 进入到加载器的位置</p><figure><img src="https://image.honahec.cc/image-20251001213906496.png" alt="image-20251001213906496" tabindex="0" loading="lazy"><figcaption>image-20251001213906496</figcaption></figure><figure><img src="https://image.honahec.cc/image-20251001214012224.png" alt="image-20251001214012224" tabindex="0" loading="lazy"><figcaption>image-20251001214012224</figcaption></figure><p>加载器内使用 call 方法来调用模块</p><p>此时我们可以先把刚才找到的写进去</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">!</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">){</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ...</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> d</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">r</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">])</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            return</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> r</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> r</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">            i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">            l</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> !</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">            exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {}</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        };</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> d</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">),</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">l</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> !</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ...</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    window</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">aaa</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> d</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">})([</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        ...</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">81</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接下来，我们去找一下模块 81，我们直接在 console 中调用</p><figure><img src="https://image.honahec.cc/image-20251001214759134.png" alt="image-20251001214759134" tabindex="0" loading="lazy"><figcaption>image-20251001214759134</figcaption></figure><figure><img src="https://image.honahec.cc/image-20251001214822300.png" alt="image-20251001214822300" tabindex="0" loading="lazy"><figcaption>image-20251001214822300</figcaption></figure><p>把加载器也拉到我们的代码里</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">!</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">){</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ...</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> d</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">r</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">])</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            return</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> r</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> r</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">            i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">            l</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> !</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">            exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {}</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        };</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> d</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">),</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">l</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> !</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ...</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    window</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">aaa</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> d</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">})([</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        ...</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> P</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> G</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">_getSecuritySign</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        delete</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> G</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">_getSecuritySign</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">default</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> P</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 导出 P</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> windows</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">aaa</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">; </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 调用1号模块</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            return</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> this</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }();</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        try</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> n</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ||</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> Function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">return this</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)()</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> catch</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">r</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">            &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">object</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> typeof</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> window</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &amp;&amp;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> window</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> n</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这就差不多了，再套个函数接收 dataStr 即可</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> getSign</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">dataStr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">    !</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">){</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        ...</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        function</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> d</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">r</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">])</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                return</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> r</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">            var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> r</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">                i</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">                l</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> !</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">                exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {}</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            };</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            return</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">].</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> d</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">),</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">l</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> !</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            a</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        ...</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">        window</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">aaa</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> d</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    })([</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            ...</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">            var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> P</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> G</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">_getSecuritySign</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">            delete</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> G</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">_getSecuritySign</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">default</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> P</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // 导出 P</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">call</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">this</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> windows</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">aaa</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">; </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 调用1号模块</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> t</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">            var</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">            n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                return</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> this</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            }();</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            try</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> n</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ||</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> Function</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">return this</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)()</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            }</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> catch</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">r</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">                &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">object</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> typeof</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> window</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &amp;&amp;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">n</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> window</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">            }</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">            e</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">exports</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> n</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    ]);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> window</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">aaa</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">).</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">default</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">dataStr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2><img src="https://image.honahec.cc/0e721a81d1b034d1561833be97d42ff0.jpg" style="zoom:33%;"><blockquote><p>虽然后面又加题被 U 题解密薄纱了（真的解不明白密）</p><p>但很好玩 又一个（也许是多个）人生第一次</p></blockquote>`,176))])}const v=r(g,[["render",y]]),m=JSON.parse('{"path":"/blog/fqlwhfh3/","title":"CTF 初探 GeekPie 社团招新赛","lang":"zh-CN","frontmatter":{"title":"CTF 初探 GeekPie 社团招新赛","createTime":"2025/10/3 10:23:32","permalink":"/blog/fqlwhfh3/","tags":["CTF","题解"],"description":"注 本文记录我初次接触 CTF 的经历，并顺带完成部分题的 writeups 文章内的用于下载文件的超链接未进行二次重传（懒），外网无法访问 题目（需要 writeups） A Copy That! COPY! THAT! CAPCHA! IN! 60s!!! 页面中将显示一个验证码，由 7 行 的诸多 IJl|1O0()i! 字符构成。 请在 60 ...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"CTF 初探 GeekPie 社团招新赛\\",\\"image\\":[\\"https://image.honahec.cc/%E6%88%AA%E5%B1%8F2025-09-30%2009.02.32.png\\",\\"https://image.honahec.cc/20251001154523039.png\\",\\"https://image.honahec.cc/20251001154501771.png\\",\\"https://image.honahec.cc/Snipaste_2025-10-01_15-51-49.png\\",\\"https://image.honahec.cc/20251001162009352.png\\",\\"https://image.honahec.cc/20251001162242780.png\\",\\"https://image.honahec.cc/20251001163840474.png\\",\\"https://image.honahec.cc/20251001165603879.png\\",\\"https://image.honahec.cc/20251001180101332.png\\",\\"https://image.honahec.cc/image-20251001180304841.png\\",\\"https://image.honahec.cc/20251001180515549.png\\",\\"https://image.honahec.cc/image-20251001212937916.png\\",\\"https://image.honahec.cc/image-20251001213509882.png\\",\\"https://image.honahec.cc/image-20251001213725867.png\\",\\"https://image.honahec.cc/image-20251001213906496.png\\",\\"https://image.honahec.cc/image-20251001214012224.png\\",\\"https://image.honahec.cc/image-20251001214759134.png\\",\\"https://image.honahec.cc/image-20251001214822300.png\\"],\\"dateModified\\":\\"2025-10-11T12:44:19.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://blog.honahec.cc/blog/fqlwhfh3/"}],["meta",{"property":"og:site_name","content":"云朵角落"}],["meta",{"property":"og:title","content":"CTF 初探 GeekPie 社团招新赛"}],["meta",{"property":"og:description","content":"注 本文记录我初次接触 CTF 的经历，并顺带完成部分题的 writeups 文章内的用于下载文件的超链接未进行二次重传（懒），外网无法访问 题目（需要 writeups） A Copy That! COPY! THAT! CAPCHA! IN! 60s!!! 页面中将显示一个验证码，由 7 行 的诸多 IJl|1O0()i! 字符构成。 请在 60 ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://image.honahec.cc/%E6%88%AA%E5%B1%8F2025-09-30%2009.02.32.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-10-11T12:44:19.000Z"}],["meta",{"property":"article:tag","content":"题解"}],["meta",{"property":"article:tag","content":"CTF"}],["meta",{"property":"article:modified_time","content":"2025-10-11T12:44:19.000Z"}]]},"readingTime":{"minutes":19.38,"words":5813},"git":{"createdTime":1760183675000,"updatedTime":1760186659000,"changelog":[{"hash":"b05b519564dad9cf084052081ec7480c00c4d12a","time":1760186659000,"email":"honahec@gmail.com","author":"Honahec","message":"Improves documentation with collapse panels and callouts"},{"hash":"ec3563c3acade135fdc89eaed9b79d11b94986d2","time":1760183675000,"email":"honahec@gmail.com","author":"Honahec","message":"Reforges the blog powered by Vuepress Plume"}]},"autoDesc":true,"filePathRelative":"blog/GeekPie2025.md","headers":[]}');export{v as comp,m as data};
