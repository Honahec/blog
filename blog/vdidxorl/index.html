<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CTF初探 GeekPie社团招新赛 | 云朵角落</title>
    <meta name="description" content="Honahec's Blog">
    <meta name="generator" content="VitePress v1.4.3">
    <link rel="preload stylesheet" href="/assets/style.CTWYgqWZ.css" as="style">
    
    <script type="module" src="/assets/app.C62GELCM.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.DJYaAeIH.js">
    <link rel="modulepreload" href="/assets/chunks/framework.ohJJpums.js">
    <link rel="modulepreload" href="/assets/blog_vdidxorl_index.md.MDpUs55l.lean.js">
    <link rel="icon" href="https://image.honahec.cc/favicon-blue.png">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-e9af63fe><!--[--><!--]--><!--[--><span tabindex="-1" data-v-5dd83c07></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-5dd83c07> Skip to content </a><!--]--><!----><header class="VPNav" data-v-e9af63fe data-v-9996814e><div class="VPNavBar" data-v-9996814e data-v-f709c725><div class="wrapper" data-v-f709c725><div class="container" data-v-f709c725><div class="title" data-v-f709c725><div class="VPNavBarTitle has-sidebar" data-v-f709c725 data-v-60b5a0e6><a class="title" href="/" data-v-60b5a0e6><!--[--><!--]--><!--[--><img class="VPImage logo" src="https://image.honahec.cc/avatar-circle.png" alt data-v-3e6dc4b9><!--]--><span data-v-60b5a0e6>云朵角落</span><!--[--><!--]--></a></div></div><div class="content" data-v-f709c725><div class="content-body" data-v-f709c725><!--[--><!--]--><div class="VPNavBarSearch search" data-v-f709c725><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-f709c725 data-v-9f09baa8><span id="main-nav-aria-label" class="visually-hidden" data-v-9f09baa8> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-9f09baa8 data-v-e520a58c><!--[--><span data-v-e520a58c>主页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/about/" tabindex="0" data-v-9f09baa8 data-v-e520a58c><!--[--><span data-v-e520a58c>关于我</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/" tabindex="0" data-v-9f09baa8 data-v-e520a58c><!--[--><span data-v-e520a58c>博客</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/friends/" tabindex="0" data-v-9f09baa8 data-v-e520a58c><!--[--><span data-v-e520a58c>友链</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-f709c725 data-v-449db419><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-449db419 data-v-03302fd3 data-v-aaf457ca><span class="check" data-v-aaf457ca><span class="icon" data-v-aaf457ca><!--[--><span class="vpi-sun sun" data-v-03302fd3></span><span class="vpi-moon moon" data-v-03302fd3></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-f709c725 data-v-efa17790 data-v-ba472311><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Honahec" aria-label="github" target="_blank" rel="noopener" data-v-ba472311 data-v-e9f89017><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-f709c725 data-v-68e407dd data-v-c9e71fa3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-c9e71fa3><span class="vpi-more-horizontal icon" data-v-c9e71fa3></span></button><div class="menu" data-v-c9e71fa3><div class="VPMenu" data-v-c9e71fa3 data-v-c46aeead><!----><!--[--><!--[--><!----><div class="group" data-v-68e407dd><div class="item appearance" data-v-68e407dd><p class="label" data-v-68e407dd>主题</p><div class="appearance-action" data-v-68e407dd><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-68e407dd data-v-03302fd3 data-v-aaf457ca><span class="check" data-v-aaf457ca><span class="icon" data-v-aaf457ca><!--[--><span class="vpi-sun sun" data-v-03302fd3></span><span class="vpi-moon moon" data-v-03302fd3></span><!--]--></span></span></button></div></div></div><div class="group" data-v-68e407dd><div class="item social-links" data-v-68e407dd><div class="VPSocialLinks social-links-list" data-v-68e407dd data-v-ba472311><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Honahec" aria-label="github" target="_blank" rel="noopener" data-v-ba472311 data-v-e9f89017><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-f709c725 data-v-6c5e2865><span class="container" data-v-6c5e2865><span class="top" data-v-6c5e2865></span><span class="middle" data-v-6c5e2865></span><span class="bottom" data-v-6c5e2865></span></span></button></div></div></div></div><div class="divider" data-v-f709c725><div class="divider-line" data-v-f709c725></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-e9af63fe data-v-5c27889d><div class="container" data-v-5c27889d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-5c27889d><span class="vpi-align-left menu-icon" data-v-5c27889d></span><span class="menu-text" data-v-5c27889d>导航栏</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-5c27889d data-v-212fd2f5><button data-v-212fd2f5>返回顶部</button><!----></div></div></div><aside class="VPSidebar" data-v-e9af63fe data-v-1e4509e3><div class="curtain" data-v-1e4509e3></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-1e4509e3><span class="visually-hidden" id="sidebar-aria-label" data-v-1e4509e3> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-5e0c801b><section class="VPSidebarItem level-0 is-link has-active" data-v-5e0c801b data-v-6017ff22><div class="item" tabindex="0" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><a class="VPLink link link" href="/blog/" data-v-6017ff22><!--[--><h2 class="text" data-v-6017ff22>博客</h2><!--]--></a><!----></div><div class="items" data-v-6017ff22><!--[--><section class="VPSidebarItem level-1" data-v-6017ff22 data-v-6017ff22><div class="item" role="button" tabindex="0" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><h3 class="text" data-v-6017ff22>项目管理与部署</h3><!----></div><div class="items" data-v-6017ff22><!--[--><div class="VPSidebarItem level-2 is-link" data-v-6017ff22 data-v-6017ff22><div class="item" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><a class="VPLink link link" href="/blog/kjrbhsvq/" data-v-6017ff22><!--[--><p class="text" data-v-6017ff22>Git</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6017ff22 data-v-6017ff22><div class="item" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><a class="VPLink link link" href="/blog/iftjzdbk/" data-v-6017ff22><!--[--><p class="text" data-v-6017ff22>Git对象</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6017ff22 data-v-6017ff22><div class="item" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><a class="VPLink link link" href="/blog/urjfhnzm/" data-v-6017ff22><!--[--><p class="text" data-v-6017ff22>pnpm</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-6017ff22 data-v-6017ff22><div class="item" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><a class="VPLink link link" href="/blog/argeggcn/" data-v-6017ff22><!--[--><p class="text" data-v-6017ff22>Actions部署Vuepress</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-6017ff22 data-v-6017ff22><div class="item" role="button" tabindex="0" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><h3 class="text" data-v-6017ff22>前端</h3><!----></div><div class="items" data-v-6017ff22><!--[--><div class="VPSidebarItem level-2 is-link" data-v-6017ff22 data-v-6017ff22><div class="item" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><a class="VPLink link link" href="/blog/wujpebwu/" data-v-6017ff22><!--[--><p class="text" data-v-6017ff22>Nginx</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-6017ff22 data-v-6017ff22><div class="item" role="button" tabindex="0" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><h3 class="text" data-v-6017ff22>后端</h3><!----></div><div class="items" data-v-6017ff22><!--[--><div class="VPSidebarItem level-2 is-link" data-v-6017ff22 data-v-6017ff22><div class="item" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><a class="VPLink link link" href="/blog/npzmqdqk/" data-v-6017ff22><!--[--><p class="text" data-v-6017ff22>JWT</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-6017ff22 data-v-6017ff22><div class="item" role="button" tabindex="0" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><h3 class="text" data-v-6017ff22>Debug 经历</h3><!----></div><div class="items" data-v-6017ff22><!--[--><div class="VPSidebarItem level-2 is-link" data-v-6017ff22 data-v-6017ff22><div class="item" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><a class="VPLink link link" href="/blog/apfmwzwg/" data-v-6017ff22><!--[--><p class="text" data-v-6017ff22>API 返回值</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 has-active" data-v-6017ff22 data-v-6017ff22><div class="item" role="button" tabindex="0" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><h3 class="text" data-v-6017ff22>比赛</h3><!----></div><div class="items" data-v-6017ff22><!--[--><div class="VPSidebarItem level-2 is-link" data-v-6017ff22 data-v-6017ff22><div class="item" data-v-6017ff22><div class="indicator" data-v-6017ff22></div><a class="VPLink link link" href="/blog/vdidxorl/" data-v-6017ff22><!--[--><p class="text" data-v-6017ff22>CTF/GeekPie招新赛</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-e9af63fe data-v-b535b4a1><div class="VPDoc has-sidebar has-aside" data-v-b535b4a1 data-v-2a6e1f71><!--[--><!--]--><div class="container" data-v-2a6e1f71><div class="aside" data-v-2a6e1f71><div class="aside-curtain" data-v-2a6e1f71></div><div class="aside-container" data-v-2a6e1f71><div class="aside-content" data-v-2a6e1f71><div class="VPDocAside" data-v-2a6e1f71 data-v-b1cec2c5><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-b1cec2c5 data-v-ba4898b3><div class="content" data-v-ba4898b3><div class="outline-marker" data-v-ba4898b3></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-ba4898b3>文章目录</div><ul class="VPDocOutlineItem root" data-v-ba4898b3 data-v-6102046d><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-b1cec2c5></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-2a6e1f71><div class="content-container" data-v-2a6e1f71><!--[--><!--]--><main class="main" data-v-2a6e1f71><div style="position:relative;" class="vp-doc _blog_vdidxorl_" data-v-2a6e1f71><div><h1 id="ctf初探-geekpie社团招新赛" tabindex="-1">CTF初探 GeekPie社团招新赛 <a class="header-anchor" href="#ctf初探-geekpie社团招新赛" aria-label="Permalink to &quot;CTF初探 GeekPie社团招新赛&quot;">​</a></h1><blockquote><p>本文记录我初次接触 CTF 的经历，并顺带完成部分题的 writeups</p><p>文章内的用于下载文件的超链接未进行二次重传（懒），外网无法访问</p></blockquote><h2 id="题目-需要-writeups" tabindex="-1">题目（需要 writeups） <a class="header-anchor" href="#题目-需要-writeups" aria-label="Permalink to &quot;题目（需要 writeups）&quot;">​</a></h2><h3 id="a-copy-that" tabindex="-1">A Copy That! <a class="header-anchor" href="#a-copy-that" aria-label="Permalink to &quot;A Copy That!&quot;">​</a></h3><p><strong>COPY!</strong></p><p><strong>THAT!</strong></p><p><strong>CAPCHA!</strong></p><p><strong>IN!</strong></p><p><strong>60s!!!</strong></p><p>页面中将显示一个验证码，由 7行 的诸多 <code>IJl|1O0()i!</code> 字符构成。 请在 60 秒之内将验证码复制下来，用你喜欢的语言输出，然后提交。</p><p>Go To: <a href="https://c0p1ed.geekpie.tech/page1" target="_blank" rel="noreferrer">https://c0p1ed.geekpie.tech/page1</a></p><h4 id="题解" tabindex="-1">题解 <a class="header-anchor" href="#题解" aria-label="Permalink to &quot;题解&quot;">​</a></h4><p>本题为签到题，比较简单</p><p>页面禁用了快捷键，但仍可 右上角三个点 -&gt; 更多工具 -&gt; 开发者工具 打开 F12</p><p>选取验证码区域，则可得到</p><p><img src="https://image.honahec.cc/%E6%88%AA%E5%B1%8F2025-09-30%2009.02.32.png" alt=""></p><p>复制即可</p><blockquote><p>另外，使用 PHP 提交是一个很好的选择，所见即所得</p></blockquote><h3 id="d-copy-that-rev-首杀" tabindex="-1">D Copy That Rev! （首杀） <a class="header-anchor" href="#d-copy-that-rev-首杀" aria-label="Permalink to &quot;D Copy That Rev! （首杀）&quot;">​</a></h3><p>“小 D，怎么回事，你的验证码弱爆了！”</p><p>“什么？怎么可能！！”</p><p>“我搜集了一下他们的手段，我猜他们大概是这样……，所以我看我们只能使用 I 公司最新研制的……”</p><p>你不屑的哼了一声，放下了监听耳机。</p><blockquote><p>由7行的诸多 IJl|1O0()i! 字符构成，但是只有一行</p><p>Go To: <a href="https://c0p1ed.geekpie.tech/page2" target="_blank" rel="noreferrer">https://c0p1ed.geekpie.tech/page2</a></p></blockquote><h4 id="题解-1" tabindex="-1">题解 <a class="header-anchor" href="#题解-1" aria-label="Permalink to &quot;题解&quot;">​</a></h4><p>本题为 A 题加强版</p><p>首先把玩一下网站，发现网站禁用了快捷键，并存在某些监听事件禁止打开 F12（打开就强制跳转）</p><p>事实上，由于学艺不精，我最终并没有完全弄明白其原理，但结合 LLM 给出信息，大致总结及实操如下</p><p>LLM 告知，网站可通过以下手段检测 F12：</p><ol><li><strong>Worker 反调试检测</strong>：许多网站不在主线程检测，而是</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Worker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;anti_debug.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//anti_debug.js</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setInterval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isDevToolsOpen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    location.href </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/hacker.html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><ol start="2"><li><strong>利用窗口大小差异</strong>：Chrome 打开 DevTools 时，浏览器窗口会被挤小</li></ol><p><strong>对于 1</strong> ，LLM 给出有效的油猴脚本：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ==UserScript==</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// @name         Worker Debugger Neutralizer (inject)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// @namespace    http://tampermonkey.net/</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// @version      1.6</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// @description  拦截并净化创建的 WebWorker，移除 debugger 死循环 &amp; 注入 importScripts wrapper（注入到页面上下文）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// @match        *://*/*</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// @run-at       document-start</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// @grant        none</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ==/UserScript==</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;use strict&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 将要注入到页面上下文的代码（字符串形式）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> INJECT_CODE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> `</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(function(){</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  // 防重复注入</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  if (window.__worker_debugger_neutralizer_installed) return;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  window.__worker_debugger_neutralizer_installed = true;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  // 简单的代码净化函数：移除 debugger; 和常见关键字（可按需扩展）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  function sanitizeCode(src) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      // 先把单行/多行注释中的 debugger 保留（不重要），真正移除语句</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      src = src.replace(/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">bdebugger</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s*;?/g, &#39;// removed debugger;&#39;);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      // 移除明显的无限断点循环形式（举例）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      src = src.replace(/for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s*let</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s+[^;]+;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s*[^;]+;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s*[^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)]+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s*{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s*debugger</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s*;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">s*}/g, &#39;// removed loop-debugger&#39;);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      // 标记/替换 devtools 单词避免检测 toString 等</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      src = src.replace(/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">bdevtools</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">b/gi, &#39;dev_tools&#39;);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      return src;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    } catch (e) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      return src;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  // 在 Worker 源码前注入 wrapper，重写 importScripts、console、setTimeout 等，尽可能先行保护</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  function makeWrapperPrefix() {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    return &#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;(function(){</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;  try{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;    const _importScripts = self.importScripts;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;    self.importScripts = function(){</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;      try{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;        const sanitizedArgs = Array.prototype.slice.call(arguments).map(function(u){</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;          // 如果是相对/绝对 URL，尝试 fetch 替换里面的 debugger（若失败回退原 URL）</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;          return u;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;        });</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;        return _importScripts.apply(self, sanitizedArgs);</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;      }catch(e){</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;        try{ return _importScripts.apply(self, arguments); }catch(e){}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;      }</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;    };</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;  }catch(e){}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;  // 防止 worker 内再触发 debugger 造成卡死</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;  try{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;    Object.defineProperty(self, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">debugger</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, { get: function(){ return undefined; }, configurable: true });</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;  }catch(e){}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;  // 覆盖 setInterval/setTimeout 以防止外部注入死循环检测</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;  try{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;    const _si = self.setInterval; const _st = self.setTimeout;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;    self.setInterval = function(fn, t){ if(typeof fn === </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">function</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">) { return _si(function(){ try{ return fn.apply(this,arguments); }catch(e){} }, t); } return _si(fn,t); };</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;    self.setTimeout = function(fn, t){ if(typeof fn === </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">function</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">) { return _st(function(){ try{ return fn.apply(this,arguments); }catch(e){} }, t); } return _st(fn,t); };</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;  }catch(e){}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; +</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;})();</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39;;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  const wrapperPrefix = makeWrapperPrefix();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  // 保存原始 Worker 构造</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  const RealWorker = window.Worker;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  const realCreateObjectURL = URL.createObjectURL.bind(URL);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  // 用于生成真实 Worker 的辅助（异步）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  async function createSanitizedWorkerFromSourceText(src, options) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      const sanitized = sanitizeCode(src);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      const finalSrc = wrapperPrefix + &#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">n&#39; + sanitized;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      const blob = new Blob([finalSrc], { type: &#39;application/javascript&#39; });</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      const blobUrl = realCreateObjectURL(blob);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      return new RealWorker(blobUrl, options);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    } catch (e) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      // 失败回退：直接尝试用原始脚本（可能包含 debugger）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        const blob = new Blob([src], { type: &#39;application/javascript&#39; });</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        const blobUrl = realCreateObjectURL(blob);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        return new RealWorker(blobUrl, options);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      } catch (ee) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        throw ee;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  // 返回一个“伪 Worker”并异步创建真实 Worker，完成后转发</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  function makeProxyWorker() {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    let _listeners = {};</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    let _onmessage = null;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    let _real = null;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    let _pendingMsgs = [];</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    let _terminated = false;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    const proxy = {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      // 标准 API：postMessage</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      postMessage: function(msg, transfer) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        if (_terminated) return;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        if (_real) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          try { _real.postMessage(msg, transfer); } catch(e) {}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        } else {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          _pendingMsgs.push({msg, transfer});</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      addEventListener: function(type, cb) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        _listeners[type] = _listeners[type] || new Set();</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        _listeners[type].add(cb);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      removeEventListener: function(type, cb) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        if (_listeners[type]) _listeners[type].delete(cb);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      terminate: function() {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        _terminated = true;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        try { if (_real) _real.terminate(); }catch(e){}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        _real = null;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        _listeners = {};</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        _pendingMsgs = [];</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      // onmessage 属性</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      set onmessage(fn) { _onmessage = fn; },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      get onmessage() { return _onmessage; },</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      // 内部：把真实 worker 绑定到代理并转发事件</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      _bindReal: function(realWorker) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        if (_terminated) { try{ realWorker.terminate(); }catch(e){}; return; }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        _real = realWorker;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        // 转发 pending messages</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        for (const p of _pendingMsgs) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          try { _real.postMessage(p.msg, p.transfer); } catch(e) {}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        _pendingMsgs = [];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        // 绑定事件转发</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        _real.onmessage = function(ev) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          // 先触发 onmessage 回调</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          try { if (typeof _onmessage === &#39;function&#39;) _onmessage.call(proxy, ev); } catch(e){}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          // 再触发 addEventListener 注册的回调</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            const s = _listeners[&#39;message&#39;];</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            if (s) for (const cb of s) { try{ cb.call(proxy, ev); }catch(e){} }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          } catch(e){}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        };</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        // 支持 messageerror</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        _real.onmessageerror = function(ev) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            const s = _listeners[&#39;messageerror&#39;];</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            if (s) for (const cb of s) { try{ cb.call(proxy, ev); }catch(e){} }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          } catch(e){}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        };</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    return proxy;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  // 覆盖 window.Worker</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  window.Worker = function(scriptURL, options) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    // 1) 如果第二个参数 omitted，options 可能为 undefined — 直接传透</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    const proxy = makeProxyWorker();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    // 异步处理各种 scriptURL 类型</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    (async function() {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        // helper: 获取脚本文本（若可行）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        async function fetchTextFrom(url) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            // 尝试 fetch（CORS 可能阻止）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            const r = await fetch(url, { credentials: &#39;same-origin&#39; });</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            if (!r.ok) throw new Error(&#39;fetch failed:&#39; + r.status);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            return await r.text();</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          } catch (e) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            // 作为回退，试试 XMLHttpRequest 同源同步（仅对同源有效）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              const xhr = new XMLHttpRequest();</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              xhr.open(&#39;GET&#39;, url, false); // 同步</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              xhr.send(null);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              if (xhr.status === 200 || (location.protocol === &#39;file:&#39; &amp;&amp; xhr.status === 0)) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                return xhr.responseText;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            } catch (ee){}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            throw e;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        // 处理不同形式的 scriptURL</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        if (typeof scriptURL === &#39;string&#39;) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          if (scriptURL.startsWith(&#39;blob:&#39;)) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            // 对 blob: URL，尝试 fetch 并读取文本</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              const txt = await (await fetch(scriptURL)).text();</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              const real = await createSanitizedWorkerFromSourceText(txt, options);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              proxy._bindReal(real);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              return;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            } catch (e) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              // 回退：直接创建原始 Worker</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              try { const real = new RealWorker(scriptURL, options); proxy._bindReal(real); return; } catch(e){}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          } else if (scriptURL.startsWith(&#39;data:&#39;)) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            // data URL：解码出内容</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              const comma = scriptURL.indexOf(&#39;,&#39;);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              const meta = scriptURL.substring(5, comma);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              const data = scriptURL.substring(comma + 1);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              const isBase64 = /base64/i.test(meta);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              const txt = isBase64 ? atob(data) : decodeURIComponent(data);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              const real = await createSanitizedWorkerFromSourceText(txt, options);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              proxy._bindReal(real);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              return;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            } catch (e) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              try { const real = new RealWorker(scriptURL, options); proxy._bindReal(real); return; } catch(e){}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          } else {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            // 普通 URL（可能跨域）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              const txt = await fetchTextFrom(scriptURL);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              const real = await createSanitizedWorkerFromSourceText(txt, options);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              proxy._bindReal(real);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              return;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            } catch (e) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              // 失败（CORS 等），回退到直接用原始 URL</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">              try { const real = new RealWorker(scriptURL, options); proxy._bindReal(real); return; } catch(e){}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        } else if (scriptURL instanceof Blob) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            const txt = await (new Response(scriptURL)).text();</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            const real = await createSanitizedWorkerFromSourceText(txt, options);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            proxy._bindReal(real);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            return;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          } catch (e) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            try { const url = realCreateObjectURL(scriptURL); const real = new RealWorker(url, options); proxy._bindReal(real); return; } catch(e){}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        // 最后回退：直接尝试构造（如果上面都没成功）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        try { const real = new RealWorker(scriptURL, options); proxy._bindReal(real); return; } catch(e){ console.error(&#39;Worker creation fallback failed&#39;, e); }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      } catch (err) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        // 万一整个流程失败，尝试直接使用原始 Worker</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        try { const real = new RealWorker(scriptURL, options); proxy._bindReal(real); } catch(e) { console.error(&#39;create worker failed&#39;, e); }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    })();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    return proxy;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  // 保证 new Worker.prototype instanceof Worker 的行为兼容（尽力）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    window.Worker.prototype = RealWorker.prototype;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  } catch(e){}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  // 覆盖 URL.createObjectURL：让 Blob-&gt;objectURL 的情况也被捕获（可选）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  (function(){</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    const orig = URL.createObjectURL.bind(URL);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    URL.createObjectURL = function(obj) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      try {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        // 直接返回原始行为（我们主要在 Worker ctor 里处理 Blob 内容）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        return orig(obj);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      } catch(e) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        return orig(obj);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    };</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  })();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">})();</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// end INJECT_CODE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 把脚本注入到页面上下文：在 documentElement 前插入一个 &lt;script&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> el</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;script&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      el.textContent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> code;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 标记并立即插入，尽量在页面脚本之前运行</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ref</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.documentElement </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.head </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.body;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (ref) ref.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(el);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.documentElement.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">appendChild</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(el);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 可选：移除脚本标签以免泄露</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">el.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">remove</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (e) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;inject failed&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, e);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">INJECT_CODE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})();</span></span></code></pre></div><p>这个脚本干了以下几件事：</p><ul><li>所有 <code>debugger</code> 都被正则替换掉</li><li><code>devtools</code> 关键字被改写</li><li><code>importScripts()</code> 里的反调试加载被中和</li></ul><p>Worker 层检测没机会触发跳转</p><p>而<strong>对于 2</strong> ，我本想让 LLM 也给出一个脚本，但失败了，于是灵机一动打开了 Devtools 的移动设备模式（跳转 hacker 页面后可打开 F12，打开后返回）</p><ul><li>开启移动模式时，Chrome 会把页面渲染在一个“模拟设备视口”中</li><li>这时 <code>innerWidth</code> / <code>outerWidth</code> 的差值几乎恒定，<strong>不会反映 DevTools 是否打开</strong></li></ul><p>因此这类检测逻辑失效</p><p>至此，可顺利打开 F12，完成了本题的 <strong>第一部分</strong></p><p>事情并没有那么简单</p><p><img src="https://image.honahec.cc/20251001154523039.png" alt=""></p><p>完整字符被分割到四个 chunk 中，每个 chunk 中又对字符进行了分割为数个 data 并赋予 id，我本以为只需手速够快，在60s内复制全部字符并提交即可，失败两次后冷静下来继续研究，页面展示的字符顺序与 Elements 中顺序并不一致：（可自行核对，上下图片为同一次请求）</p><p><img src="https://image.honahec.cc/20251001154501771.png" alt=""></p><p>简单观察我们可以轻松得到第一个结论：<strong>四个 chunk 是按照顺序出现的</strong></p><p>难点在于，chunk 内部字符如何排序？</p><p>对此 div 的 sytle 进行简单探索，找到如下代码：</p><p><img src="https://image.honahec.cc/Snipaste_2025-10-01_15-51-49.png" alt=""></p><p>此处给出了 chunk 内元素的排序规则：<strong>先 before 再 after，内部按先后排序</strong></p><p>到此，最快的方法就是使用合适的 prompt，给 LLM style和四个 chunk 让它 <strong>不要废话</strong> 给出最终的完整字符</p><h3 id="g-git" tabindex="-1">G Git <a class="header-anchor" href="#g-git" aria-label="Permalink to &quot;G Git&quot;">​</a></h3><p>Flag was hidden in Git repositories. Find them.</p><p><a href="https://acm.shanghaitech.edu.cn/d/G3eKP1E_2025/p/10/file/Git.zip?type=additional_file" target="_blank" rel="noreferrer">Download repos</a></p><h4 id="题解-2" tabindex="-1">题解 <a class="header-anchor" href="#题解-2" aria-label="Permalink to &quot;题解&quot;">​</a></h4><p>本题给出了四个 Git 仓库，并考察 Git对象 知识，可查看我博客上的相关内容：<a href="/blog/iftjzdbk/">Git对象</a>（外部跳转请访问 <a href="https://blog.honahec.cc/blog/iftjzdbk/" target="_blank" rel="noreferrer">Git对象</a>）</p><p>涵盖了本题考察内容</p><h3 id="h-不知名观光地" tabindex="-1">H 不知名观光地 <a class="header-anchor" href="#h-不知名观光地" aria-label="Permalink to &quot;H 不知名观光地&quot;">​</a></h3><p>你从 ??? 那里获得了一份 <a href="https://acm.shanghaitech.edu.cn/d/G3eKP1E_2025/p/10/file/12345678?type=additional_file" target="_blank" rel="noreferrer">神秘文件 (?)</a></p><p>如果是你的话，一定能追逐到属于自己的■■■■吧</p><h4 id="题解-3" tabindex="-1">题解 <a class="header-anchor" href="#题解-3" aria-label="Permalink to &quot;题解&quot;">​</a></h4><p><s>也许本题才是签到题（？</s></p><p>本题给出了一张图片和一个 readme.txt</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//readme.txt</span></span>
<span class="line"><span>VkdobElHNWxZWEpsYzNRZ2RISmhhVzRnYzNSaGRHbHZiam9nWDE5ZlgxOGdVM1JoZEdsdmJpQW9SVzVuYkdsemFDQnZibXg1SVNrPQ==</span></span></code></pre></div><p>最后具有两个等号（base64补位字符），简单判断这是 base64 编码内容</p><p>解码一次后</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//From base64 1</span></span>
<span class="line"><span>VGhlIG5lYXJlc3QgdHJhaW4gc3RhdGlvbjogX19fX18gU3RhdGlvbiAoRW5nbGlzaCBvbmx5ISk=</span></span></code></pre></div><p>最后还有一个等号，应该还可以继续解码</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>//From base64 2</span></span>
<span class="line"><span>The nearest train station: _____ Station (English only!)</span></span></code></pre></div><p>那本题很明了了，判断图片位置并找出最近车站</p><img src="https://image.honahec.cc/congratulations.png" style="zoom:20%;"><p>出题人十分友好，图片可直接扔 Google 搜索到，加上内置的 Gemeni 就秒掉了</p><p><img src="https://image.honahec.cc/20251001162009352.png" alt=""></p><h3 id="i-❖-kaleid×scope-❖" tabindex="-1">I ❖ 𝐊𝐀𝐋𝐄𝐈𝐃×𝐒𝐂𝐎𝐏𝐄 ❖ <a class="header-anchor" href="#i-❖-kaleid×scope-❖" aria-label="Permalink to &quot;I ❖ 𝐊𝐀𝐋𝐄𝐈𝐃×𝐒𝐂𝐎𝐏𝐄 ❖&quot;">​</a></h3><blockquote><p>「六面海报，六道回声。 当光被切分成碎片，世界会在碎缝里低语——听见它的人，会把碎片拼回。」</p></blockquote><p>你被昏暗中召唤。 在废弃剧院的后台，在舞台掩映处， 六张海报被撕裂，散落在墙壁、舞台侧翼、道具箱底。 每一张都像是一个节拍、一次回声、一段折光——它们彼此独立，却又被同一条隐秘的线牵连。</p><p>当你按顺序拾起六个 key， 光谱将重组，旗帜将升起。</p><p><img src="https://image.honahec.cc/20251001162242780.png" alt=""></p><h4 id="题解-4" tabindex="-1">题解 <a class="header-anchor" href="#题解-4" aria-label="Permalink to &quot;题解&quot;">​</a></h4><p>本题为此次比赛唯二的线下题之一，首先需要在学校各处找海报（6张有二维码的）</p><blockquote><p>海报不在此处贴出了</p></blockquote><p>这六个二维码分别给出了以下链接</p><p><a href="https://2025.geekpie.club/Arch" target="_blank" rel="noreferrer">https://2025.geekpie.club/Arch</a></p><p><a href="https://2025.geekpie.club/Web" target="_blank" rel="noreferrer">https://2025.geekpie.club/Web</a></p><p><a href="https://2025.geekpie.club/CTF" target="_blank" rel="noreferrer">https://2025.geekpie.club/CTF</a></p><p><a href="https://2025.geekpie.club/HardCore" target="_blank" rel="noreferrer">https://2025.geekpie.club/HardCore</a></p><p><a href="https://2025.geekpie.club/HPC" target="_blank" rel="noreferrer">https://2025.geekpie.club/HPC</a></p><p><a href="https://2025.geekpie.club/DevOps" target="_blank" rel="noreferrer">https://2025.geekpie.club/DevOps</a></p><p>相较于 <a href="https://2025.geekpie.club" target="_blank" rel="noreferrer">https://2025.geekpie.club</a>，简单观察网站后不难发现，这些网站下方的Terminal中多出了两段（Arch为一段，无next_hash）内容：（以 /Web 为例）</p><p><img src="https://image.honahec.cc/20251001163840474.png" alt=""></p><p>整理可得：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/Arch </span></span>
<span class="line"><span>fragment = &quot;_-_-__-_&quot;)}&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/Web</span></span>
<span class="line"><span>fragment = &quot;if(scan==6)_&quot;</span></span>
<span class="line"><span>next_hash: ac0f686269601e20f9e587992e2b4fb0e50ccae8647eed01694d23c78815e731</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/CTF</span></span>
<span class="line"><span>fragment: &quot;GEEK&quot;</span></span>
<span class="line"><span>next_hash: 37dd2c2e535a3c39b1a73cd610bb9c523614350aadceafd6571c23b6f1218b95</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/HardCore</span></span>
<span class="line"><span>fragment: &quot;PIE{&quot;</span></span>
<span class="line"><span>next_hash: 75dd84ad438833f05c559d7d7aed325d2ad5d19f77ef257561ddeb74bae9f156</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/HPC</span></span>
<span class="line"><span>fragment: &quot;--_------&quot;</span></span>
<span class="line"><span>next_hash: debd8c9a239afcab371dda416f4521b66979ae356894cc67ca320d7a74a5b6be</span></span>
<span class="line"><span></span></span>
<span class="line"><span>/DevOps</span></span>
<span class="line"><span>fragment: &quot;print(&quot;GeekPie&quot;</span></span>
<span class="line"><span>next_hash: 1f649cdf7e7c8558c988059adcf546a9b6f902c4543c28092dc598511bd6a41d</span></span></code></pre></div><p>思路一目了然</p><table tabindex="0"><thead><tr><th>模块名</th><th>fragment</th><th>SHA256(fragment)</th><th>next_hash指向</th></tr></thead><tbody><tr><td>CTF</td><td>GEEK</td><td>b90172fa...</td><td>HardCore</td></tr><tr><td>HardCore</td><td>PIE{</td><td>37dd2c2e...b95</td><td>Web</td></tr><tr><td>Web</td><td>if(scan==6)_</td><td>75dd84ad...156</td><td>DevOps</td></tr><tr><td>DevOps</td><td>print(&quot;GeekPi`</td><td>ac0f6862...e731</td><td>HPC</td></tr><tr><td>HPC</td><td>--_-----</td><td>1f649cdf...a41d</td><td>Arch</td></tr><tr><td>Arch</td><td><em>-</em>-__-_&quot;)}</td><td>debd8c9a...b6be</td><td></td></tr></tbody></table><p>则 flag 为 <code>GEEKPIE{if(scan==6)_print(&quot;GeekPie--_------_-_-__-_&quot;)}</code></p><h3 id="l-can-u-tell-me-how-much-the-shirt-is" tabindex="-1">L Can u tell me how much the shirt is? <a class="header-anchor" href="#l-can-u-tell-me-how-much-the-shirt-is" aria-label="Permalink to &quot;L Can u tell me how much the shirt is?&quot;">​</a></h3><blockquote><p>怎么CTF还有听力题😭👊</p></blockquote><p><strong>小故事</strong></p><p>出题人小时候英语听力没认真做被扣分了</p><p><strong>描述</strong></p><p>这是一个基于 Unity 的听力播放软件。</p><p>你需要先根据自己的平台下载附件，提供 <a href="https://acm.shanghaitech.edu.cn/d/G3eKP1E_2025/p/10/file/Windows.zip?type=additional_file" target="_blank" rel="noreferrer">Windows</a> 和 <a href="https://acm.shanghaitech.edu.cn/d/G3eKP1E_2025/p/10/file/MacOS.zip?type=additional_file" target="_blank" rel="noreferrer">MacOS</a> 版本。</p><blockquote><p>Note: 不保证在所有系统版本下都能运行。如果你没有兼容的系统，可以尝试运行虚拟机或云电脑。但如果你使用 Windows 或 MacOS 却不能直接运行，请及时反馈喵！</p></blockquote><p><strong>注意</strong></p><ol><li>你应该<strong>仅</strong>提交形如 GEEKPIE{...} 的 flag，{...} 内没有多余的括号，<strong>不需要使用代码输出</strong></li><li>鉴于本题 flag 形式的特殊性，接受忽略大小写的内容</li><li>提交中不应包含任何空白字符，比如 <code>ㅤ</code> 或tab、换行符</li></ol><h4 id="题解-5" tabindex="-1">题解 <a class="header-anchor" href="#题解-5" aria-label="Permalink to &quot;题解&quot;">​</a></h4><p>人脉题，无需多言，一看到音频我没有任何犹豫扔给了我的好哥们 <a href="https://github.com/modenicheng" target="_blank" rel="noreferrer">@Modenc</a></p><p>不负众 <s>（也许不众）</s> 望，历时两个半小时解决（（</p><img src="https://image.honahec.cc/e1dbcf0eb71f763af3d6056f8b336c97.jpg" style="zoom:50%;"><p>附他的<a href="https://modenc.top/article/noeu6vz4/" target="_blank" rel="noreferrer">博客题解</a>（20251004后链接有效）</p><h3 id="m-electronic-engineering" tabindex="-1">M Electronic Engineering <a class="header-anchor" href="#m-electronic-engineering" aria-label="Permalink to &quot;M Electronic Engineering&quot;">​</a></h3><p><strong>说明</strong></p><p>下方左数第二个<strong>TSSOP-16</strong>封装的元件为<strong>TMUX1108</strong>。请自行查询相关资料，以及实际的电路连接方式等信息，回答以下问题。</p><p>当我需要读取网络名为<strong>ADCL3</strong>的数据时，该元件除电源引脚外，哪些引脚需要被拉高/低？请填写相关引脚，并将剩下的引脚留空。请进入<a href="http://139.196.14.200:11456/" target="_blank" rel="noreferrer">这个链接</a>查阅具体信息，并将输出的flag提交。</p><p><img src="https://image.honahec.cc/20251001165603879.png" alt=""></p><h4 id="题解-6" tabindex="-1">题解 <a class="header-anchor" href="#题解-6" aria-label="Permalink to &quot;题解&quot;">​</a></h4><p>是完全盲区的方向</p><p>感觉 LLM 很难做出来这种题（主要我不知道怎么写prompt和解释线路如何连接的）于是先让它简要介绍一下 TMUX1108 和 这道题让我们做的事，得到了很惊喜的回复：</p><p><strong>芯片工作原理：TMUX1108 是 1-选-8 模拟多路复用器</strong></p><p>也就是说，一个公共端 D，可以通过控制信号 A2、A1、A0 选择接通到其中一个输入端 S1–S8。</p><p>它的核心控制逻辑是 <strong>3位二进制地址</strong>：</p><blockquote><p>A2A1A0 → 选择 Sx</p></blockquote><p>而且它还有一个 <strong>EN（使能）</strong> 引脚，</p><ul><li>当 EN = 1（高电平） 时，芯片正常工作，</li><li>当 EN = 0（低电平） 时，所有通道都断开（高阻状态）。</li></ul><p><strong>地址真值表（来自 TI 官方 datasheet）</strong></p><table tabindex="0"><thead><tr><th>A2</th><th>A1</th><th>A0</th><th>选通通道</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>S1</td></tr><tr><td>0</td><td>0</td><td>1</td><td>S2</td></tr><tr><td>0</td><td>1</td><td>0</td><td>S3</td></tr><tr><td>0</td><td>1</td><td>1</td><td>S4</td></tr><tr><td>1</td><td>0</td><td>0</td><td>S5</td></tr><tr><td>1</td><td>0</td><td>1</td><td>S6</td></tr><tr><td>1</td><td>1</td><td>0</td><td>S7</td></tr><tr><td>1</td><td>1</td><td>1</td><td>S8</td></tr></tbody></table><p><strong>转换成引脚编号（TSSOP-16 封装）</strong></p><table tabindex="0"><thead><tr><th>引脚号</th><th>名称</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>A0</td><td>地址最低位</td></tr><tr><td>2</td><td>EN</td><td>使能，高有效</td></tr><tr><td>15</td><td>A2</td><td>地址最高位</td></tr><tr><td>16</td><td>A1</td><td>地址中间位</td></tr></tbody></table><p>也就是说，只要控制好 <strong>引脚 1、2、15、16</strong> 的电平，就能选通不同的 S 通道</p><p>这是一个非常好的消息（可枚举）</p><p>于是，我让 LLM 给出了所有可能性：</p><table tabindex="0"><thead><tr><th>通道</th><th>A2</th><th>A1</th><th>A0</th><th>EN</th><th>对应引脚设置（1,2,15,16）</th></tr></thead><tbody><tr><td>S1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1=低，2=高，15=低，16=低</td></tr><tr><td>S2</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1=高，2=高，15=低，16=低</td></tr><tr><td>S3</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1=低，2=高，15=低，16=高</td></tr><tr><td>S4</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1=高，2=高，15=低，16=高</td></tr><tr><td>S5</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1=低，2=高，15=高，16=低</td></tr><tr><td>S6</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1=高，2=高，15=高，16=低</td></tr><tr><td>S7</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1=低，2=高，15=高，16=高</td></tr><tr><td>S8</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1=高，2=高，15=高，16=高</td></tr></tbody></table><p>枚举即可完成</p><h3 id="q-hello-shtechcraft" tabindex="-1">Q Hello SHTechCraft <a class="header-anchor" href="#q-hello-shtechcraft" aria-label="Permalink to &quot;Q Hello SHTechCraft&quot;">​</a></h3><p><strong>题目描述</strong></p><p>这是一个 <strong>DevOps 方向的题目</strong>。 你需要参考 <a href="https://github.com/HenryZ16/shtechcraft-tutorial" target="_blank" rel="noreferrer">shtechcraft-tutorial</a>，并完成以下任务。</p><hr><p><strong>任务要求</strong></p><ol><li>编写 Dockerfile</li></ol><p>你的 Dockerfile 应该能够构建出一个可直接运行的 <strong>Minecraft 原版 1.21.8 服务器</strong>。</p><p>具体要求：</p><ul><li>基础镜像：使用 hello-shtechcraft-base:v1 <ul><li>它包含一个 RCON_PASSWORD 环境变量</li></ul></li><li>配置 RCON 连接： <ul><li>RCON 密码需要从环境变量 RCON_PASSWORD 获取</li><li>评测器会通过宿主机的 30075 端口来测试 RCON</li></ul></li></ul><p>构建完成后，镜像的名称应为：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>hello-shtechcraft:v1</span></span></code></pre></div><ol start="2"><li>运行服务器</li></ol><p>你需要提供用于 docker run 的完整参数，保证服务器正常启动。</p><p>要求：</p><ul><li>挂载题目提供的存档 world.tar.gz（需要先解压）</li><li>开放 RCON 端口</li><li>运行镜像 hello-shtechcraft:v1</li></ul><p>当服务器成功启动后，你需要运行题目提供的本地评测器进行测试。</p><hr><p><strong>评分方式</strong></p><p>本题采用 <strong>本地运行 + 动态 flag 提交</strong> 的评测方式。</p><p>你需要提交以下形式的代码：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;your flag&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>其中 <code>&lt;your flag&gt;</code> 是本地评测器输出的结果，例如：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>flag{XXXead3f}</span></span></code></pre></div><p>本地评测器的工作流程</p><ol><li>要求输入： <ul><li>启动镜像所用的参数（不需要 -d 和 --name）</li></ul></li><li>检测内容： <ul><li>MC 版本：通过 /version 命令，验证是否运行了 1.21.8 版本</li><li>存档内容：检查某个坐标的方块，验证是否正确挂载存档目录</li></ul></li><li>验证通过后： <ul><li>评测器会要求输入 usercert</li><li>输入正确后，评测器输出 flag</li></ul></li></ol><p>只有通过全部检测后，才能获得本题分数。</p><p>该评分方式旨在模拟真实场景下，用 docker 封装的网络服务。它们首先要能保证响应用户的交互；其次还需要保证能持久化自己的数据</p><p><strong>注意</strong>，如果你在 Windows 平台进行测试，local checker 并不能自动超时退出。如果你的等待时间过长，请手动结束 local checker，并检查你配置的镜像，或输入的 docker run 参数等</p><p>（题目太长省略掉后面的）</p><h4 id="题解-7" tabindex="-1">题解 <a class="header-anchor" href="#题解-7" aria-label="Permalink to &quot;题解&quot;">​</a></h4><blockquote><p>环境 Windows11 + wsl2(debian)</p></blockquote><p>首先导入基础镜像</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker load </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i .\hello</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">shtechcraft</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">base</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">v1.tar</span></span></code></pre></div><p>新建一个文件夹放必要文件，并解压world到同级目录</p><ul><li>Dockerfile</li><li>start.sh</li><li>server.properties.tmpl</li><li>server-1.21.8.jar</li><li>java21.deb</li><li>world</li></ul><p><strong>配置 Dockerfile</strong></p><div class="language-dockerfile vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">dockerfile</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 基础镜像</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hello-shtechcraft-base:v1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WORKDIR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /mc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装 Java 21</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> java21.deb /tmp/java21.deb</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> apt-get update &amp;&amp; \</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    dpkg -i /tmp/java21.deb || (apt-get -f install -y &amp;&amp; dpkg -i /tmp/java21.deb) &amp;&amp; \</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rm -f /tmp/java21.deb &amp;&amp; \</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 放入原版 1.21.8 服务端</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> server-1.21.8.jar /mc/server.jar</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动脚本 &amp; 配置模板</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> start.sh /usr/local/bin/start.sh</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> server.properties.tmpl /mc/server.properties.tmpl</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> chmod +x /usr/local/bin/start.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># JVM 默认参数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ENV</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JVM_OPTS=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-Xms512m -Xmx2g&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 开放端口</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">EXPOSE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 25565 25575</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 挂载点</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VOLUME</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/mc/world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/mc/logs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ENTRYPOINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/usr/local/bin/start.sh&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><p><strong>配置 start.sh</strong></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/usr/local/bin bash</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -euo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pipefail</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># EULA</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;eula=true&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mc/eula.txt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 防止没有 server.properties</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /mc/server.properties ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mc/server.properties.tmpl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mc/server.properties</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 从环境变量取 RCON_PASSWORD，防止意外留 -changeme（实际没用）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RCON_VAL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RCON_PASSWORD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">changeme</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mc/server.properties.new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">enable-rcon=true</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">rcon.port=25575</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">rcon.password=${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RCON_VAL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">level-name=world</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">motd=Hello ShTechCraft 1.21.8</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">enable-query=true</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">server-ip=</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">server-port=25565</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mc/server.properties.new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mc/server.properties</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动原版 MC</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> java</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ${JVM_OPTS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-Xms512m -Xmx2g&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /mc/server.jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nogui</span></span></code></pre></div><p><strong>server.properties.tmpl</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>allow-flight=false</span></span>
<span class="line"><span>difficulty=easy</span></span>
<span class="line"><span>gamemode=survival</span></span>
<span class="line"><span>pvp=true</span></span>
<span class="line"><span>max-players=20</span></span>
<span class="line"><span>view-distance=10</span></span>
<span class="line"><span>simulation-distance=10</span></span>
<span class="line"><span>online-mode=true</span></span>
<span class="line"><span>spawn-protection=0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>server-port=25565</span></span>
<span class="line"><span>query.port=25565</span></span>
<span class="line"><span></span></span>
<span class="line"><span>level-name=world</span></span>
<span class="line"><span></span></span>
<span class="line"><span>enable-rcon=false</span></span>
<span class="line"><span>rcon.port=25575</span></span>
<span class="line"><span>rcon.password=</span></span></code></pre></div><p><strong>构建镜像</strong></p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">docker build </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">t hello</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">shtechcraft:v1 .</span></span></code></pre></div><p>随后写个 your-args.txt （懒得想名字了，就这个吧）</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>-p 30075:25575 -v /mnt/c/path/to/world:/mc/world hello-shtechcraft:v1</span></span>
<span class="line"><span>&lt;usercert&gt;</span></span></code></pre></div><p>在 wsl2 里跑起来（其实 windows 也可以，但我 debug 的时候去debian里跑了）</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./local_checker</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> your-args.txt</span></span></code></pre></div><p>至此，得到了 flag</p><h2 id="题目-不需要-writeups" tabindex="-1">题目（不需要 writeups） <a class="header-anchor" href="#题目-不需要-writeups" aria-label="Permalink to &quot;题目（不需要 writeups）&quot;">​</a></h2><blockquote><p>本部分题目我未在前三完成，理论上不需要写 writeups，但我想写</p></blockquote><h3 id="n-不是网易云" tabindex="-1">N 不是网易云 <a class="header-anchor" href="#n-不是网易云" aria-label="Permalink to &quot;N 不是网易云&quot;">​</a></h3><p><strong>背景</strong></p><p><strong>注意：本题仅供学习使用</strong></p><p>Yanami Anna 想要制作一个爬虫（？，而日常使用得最多的音乐平台无非网易云或者QQ音乐。毫无疑问，网易云一点加密也没有的接口（不过现在<em>部分</em>有了）被她瞬间秒掉。邪恶的眼睛盯上了QQ音乐，却发现了“超高难度”加密接口！</p><p>由于需求不高，你只需要考虑一种简单的情况（当然其他情况也类似），尝试调用QQ音乐的接口，根据专辑的MID获取专辑具体信息（包括专辑名称、封面图片、每首歌曲的信息等）。</p><p><strong>说明</strong></p><p>众所周知（?）<a href="https://music.qq.com/" target="_blank" rel="noreferrer">QQ音乐网页端</a> 在请求各类数据时会 POST 这样的接口：<a href="https://u6.y.qq.com/cgi-bin/musics.fcg?_=1757578164322&amp;encoding=ag-1&amp;sign=zzc1094ddshenmishuzidesignootkfvnthisisfake" target="_blank" rel="noreferrer">https://u6.y.qq.com/cgi-bin/musics.fcg?_=1757578164322&amp;encoding=ag-1&amp;sign=zzc1094ddshenmishuzidesignootkfvnthisisfake</a></p><p>而这其中 sign 是某个函数传入 payload（大概率是 JSON）后计算出的开头为 &quot;zzc&quot; 的一个字符串（注意是 zzc 而非旧版的 zzb）。你需要提取出相关代码（提示：无需破解具体算法）。</p><p><a href="https://acm.shanghaitech.edu.cn/d/G3eKP1E_2025/p/10/file/qqmusic.zip?type=additional_file" target="_blank" rel="noreferrer">点击此处下载附件</a> 附件给出了模板代码，你需要完善 getSign 函数，并使用这份 Node.js 脚本获取任意你喜欢的专辑的具体信息。</p><p>可以使用下面的命令行运行代码（需要先安装 Node.js 环境）</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> qqmusic_album.js</span></span></code></pre></div><p><strong>注意</strong>：不要随意修改附件给出的模拟浏览器环境 （除非你明白为什么要这么做），否则会影响最终 sign 值。</p><h4 id="题解-8" tabindex="-1">题解 <a class="header-anchor" href="#题解-8" aria-label="Permalink to &quot;题解&quot;">​</a></h4><p>依旧人脉题，本题扔给了我的另一个好哥们 <a href="https://github.com/yxzlwz" target="_blank" rel="noreferrer">@yxzlwz</a></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// submit_template.js</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 模板已更新：你只需要完成这个函数即可，不需要包含模拟环境</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 你不能在这个文件中使用 require, global 等关键字</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getSign</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dataStr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // TODO</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>看起来就是传入一个 dataStr 返回 sign 即可</p><p>首先把玩一下 QQ 音乐的网站，全局搜索一下为 sign 赋值的地方：</p><p><img src="https://image.honahec.cc/20251001180101332.png" alt=""></p><p>随后给可疑的地方打上断点，找到 sign 的值</p><p><img src="https://image.honahec.cc/image-20251001180304841.png" alt="image-20251001180304841"></p><p>很明显就是这个 P 返回了 sign，我们跳过去看看是什么牛鬼蛇神</p><p><img src="https://image.honahec.cc/20251001180515549.png" alt=""></p><p>进来之后我们可以发现这是一个 webpack 打包的格式</p><p>在这个函数里，我们找 P 是在哪里导出的</p><p><img src="https://image.honahec.cc/image-20251001212937916.png" alt="image-20251001212937916"></p><p>这个 _getSecuritySign 就应该是它签名的算法</p><p>对于常规的 Webpack 我们要找到它的加载器和模块，使用加载器来调用模块</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 加载器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})([</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 模块</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre></div><p>在刚才那个函数的最后，我们可以发现</p><p><img src="https://image.honahec.cc/image-20251001213509882.png" alt="image-20251001213509882"></p><p>这个 n 就是来调模块的，我们在这里打个断点看看</p><p><img src="https://image.honahec.cc/image-20251001213725867.png" alt="image-20251001213725867"></p><p>这个 m 就是这个加载器可以调用的模块</p><p>此时我们可以使用 DevTools 进入到加载器的位置</p><p><img src="https://image.honahec.cc/image-20251001213906496.png" alt="image-20251001213906496"></p><p><img src="https://image.honahec.cc/image-20251001214012224.png" alt="image-20251001214012224"></p><p>加载器内使用 call 方法来调用模块</p><p>此时我们可以先把刚才找到的写进去</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (r[t])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r[t].exports;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r[t] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            i: t,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            l: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            exports: {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e[t].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a.exports, a, a.exports, d),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        a.l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        a.exports</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    window.aaa </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})([</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">81</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre></div><p>接下来，我们去找一下模块81，我们直接在 console 中调用</p><p><img src="https://image.honahec.cc/image-20251001214759134.png" alt="image-20251001214759134"></p><p><img src="https://image.honahec.cc/image-20251001214822300.png" alt="image-20251001214822300"></p><p>把加载器也拉到我们的代码里</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (r[t])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r[t].exports;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r[t] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            i: t,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            l: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            exports: {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e[t].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a.exports, a, a.exports, d),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        a.l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        a.exports</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    window.aaa </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d; </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})([</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> G</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">._getSecuritySign;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        delete</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> G</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">._getSecuritySign;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        t.default </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> P</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 导出 P</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, windows.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aaa</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 调用1号模块</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;return this&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (r) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;object&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ===</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        e.exports </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre></div><p>这就差不多了，再套个函数接收 dataStr 即可</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getSign</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dataStr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (r[t])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r[t].exports;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> r[t] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                i: t,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                l: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                exports: {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e[t].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a.exports, a, a.exports, d),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            a.l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            a.exports</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        window.aaa </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d; </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })([</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            var</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> G</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">._getSecuritySign;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            delete</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> G</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">._getSecuritySign;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            t.default </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> P</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 导出 P</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, windows.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aaa</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 调用1号模块</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;return this&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (r) {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &quot;object&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ===</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            e.exports </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aaa</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dataStr)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><img src="https://image.honahec.cc/0e721a81d1b034d1561833be97d42ff0.jpg" style="zoom:33%;"><blockquote><p>虽然后面又加题被 U 题解密薄纱了（真的解不明白密）</p><p>但很好玩 又一个（也许是多个）人生第一次</p></blockquote></div></div></main><footer class="VPDocFooter" data-v-2a6e1f71 data-v-2a605689><!--[--><!--[--><!--[--><!--[--><section class="license-wrapper vp-doc" data-v-03155fbb><h2 id="copyright" class="license-heading" data-v-03155fbb> 版权所有 <a class="header-anchor" href="#copyright" aria-label="Permalink to 版权所有" aria-hidden="true" data-v-03155fbb></a></h2><div class="license-card" data-v-03155fbb><div class="license-row" data-v-03155fbb><span class="license-label" data-v-03155fbb>本文链接：</span><a class="license-link" href="https://blog.honahec.cc/blog/vdidxorl/" target="_blank" rel="noopener noreferrer" data-v-03155fbb>https://blog.honahec.cc/blog/vdidxorl/</a></div><!----><!----><div class="license-row" data-v-03155fbb><span class="license-label" data-v-03155fbb>许可：</span><a class="license-link" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer" data-v-03155fbb>署名-非商业性-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)</a></div></div></section><!--]--><!--]--><!--]--><!--]--><div class="edit-info" data-v-2a605689><!----><div class="last-updated" data-v-2a605689><p class="VPLastUpdated" data-v-2a605689 data-v-ff3eceaf>最后更新于: <time datetime="2025-10-10T04:47:08.000Z" data-v-ff3eceaf></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-2a605689><span class="visually-hidden" id="doc-footer-aria-label" data-v-2a605689>Pager</span><div class="pager" data-v-2a605689><a class="VPLink link pager-link prev" href="/blog/apfmwzwg/" data-v-2a605689><!--[--><span class="desc" data-v-2a605689>上一页</span><span class="title" data-v-2a605689>API 返回值</span><!--]--></a></div><div class="pager" data-v-2a605689><!----></div></nav></footer><!--[--><!--[--><!--[--><div style="margin-top:24px;"><!----></div><!--]--><!--]--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-e9af63fe data-v-188e5e38><div class="container" data-v-188e5e38><p class="message" data-v-188e5e38><a href="https://beian.miit.gov.cn/" target="_blank">鲁ICP备2024119517号-1</a></p><p class="copyright" data-v-188e5e38>Copyright © 2021-2025 Honahec | <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about_index.md\":\"Di_2T5KQ\",\"about_v1.md\":\"4PRiMoHm\",\"blog_apfmwzwg_index.md\":\"Kf-HoR0H\",\"blog_argeggcn_index.md\":\"CXrWD_Ts\",\"blog_iftjzdbk_index.md\":\"Bq2xDKov\",\"blog_index.md\":\"Dev9M56g\",\"blog_kjrbhsvq_index.md\":\"DgHy2Px8\",\"blog_npzmqdqk_index.md\":\"CPYaAxr9\",\"blog_urjfhnzm_index.md\":\"D1IUlNjv\",\"blog_vdidxorl_index.md\":\"MDpUs55l\",\"blog_wujpebwu_index.md\":\"BdUZw_nD\",\"friends_apply.md\":\"n9KhS7NW\",\"friends_index.md\":\"CqZtVecP\",\"index.md\":\"Cs00qk9K\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"云朵角落\",\"description\":\"Honahec's Blog\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"siteUrl\":\"https://blog.honahec.cc\",\"logo\":\"https://image.honahec.cc/avatar-circle.png\",\"nav\":[{\"text\":\"主页\",\"link\":\"/\"},{\"text\":\"关于我\",\"link\":\"/about/\"},{\"text\":\"博客\",\"link\":\"/blog/\"},{\"text\":\"友链\",\"link\":\"/friends/\"}],\"sidebar\":{\"/about/\":[{\"text\":\"关于我\"}],\"/blog/\":[{\"text\":\"博客\",\"link\":\"/blog/\",\"items\":[{\"text\":\"项目管理与部署\",\"items\":[{\"text\":\"Git\",\"link\":\"/blog/kjrbhsvq/\"},{\"text\":\"Git对象\",\"link\":\"/blog/iftjzdbk/\"},{\"text\":\"pnpm\",\"link\":\"/blog/urjfhnzm/\"},{\"text\":\"Actions部署Vuepress\",\"link\":\"/blog/argeggcn/\"}]},{\"text\":\"前端\",\"items\":[{\"text\":\"Nginx\",\"link\":\"/blog/wujpebwu/\"}]},{\"text\":\"后端\",\"items\":[{\"text\":\"JWT\",\"link\":\"/blog/npzmqdqk/\"}]},{\"text\":\"Debug 经历\",\"items\":[{\"text\":\"API 返回值\",\"link\":\"/blog/apfmwzwg/\"}]},{\"text\":\"比赛\",\"items\":[{\"text\":\"CTF/GeekPie招新赛\",\"link\":\"/blog/vdidxorl/\"}]}]}],\"/friends/\":[{\"text\":\"友链\",\"link\":\"/friends/\"},{\"text\":\"友链申请\",\"link\":\"/friends/apply/\"}]},\"search\":{\"provider\":\"local\",\"options\":{\"miniSearch\":{\"options\":{},\"searchOptions\":{}},\"translations\":{\"button\":{\"buttonText\":\"搜索\",\"buttonAriaLabel\":\"搜索\"},\"modal\":{\"noResultsText\":\"无法找到相关结果\",\"resetButtonTitle\":\"清除搜索条件\",\"footer\":{\"selectText\":\"选择\",\"navigateText\":\"切换\",\"closeText\":\"关闭\"}}}}},\"footer\":{\"message\":\"<a href=\\\"https://beian.miit.gov.cn/\\\" target=\\\"_blank\\\">鲁ICP备2024119517号-1</a>\",\"copyright\":\"Copyright © 2021-2025 Honahec | <a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" target=\\\"_blank\\\">CC BY-NC-SA 4.0</a>\"},\"license\":{\"name\":\"署名-非商业性-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0)\",\"link\":\"https://creativecommons.org/licenses/by-nc-sa/4.0/\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/Honahec\"}],\"docFooter\":{\"prev\":\"上一页\",\"next\":\"下一页\"},\"outline\":{\"level\":[2,6],\"label\":\"文章目录\"},\"lastUpdated\":{\"text\":\"最后更新于\",\"formatOptions\":{\"dateStyle\":\"short\",\"timeStyle\":\"short\"}},\"langMenuLabel\":\"选择语言\",\"returnToTopLabel\":\"返回顶部\",\"sidebarMenuLabel\":\"导航栏\",\"darkModeSwitchLabel\":\"主题\",\"lightModeSwitchTitle\":\"浅色模式\",\"darkModeSwitchTitle\":\"深色模式\"},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>